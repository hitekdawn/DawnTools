local vW22p02mh7={[1]="\65\99\101\65\100\100\111\110\45\51\46\48",[2]="\68\97\119\110\84\111\111\108\115",[3]="\68\97\119\110\84\114\97\100\101\76\111\103",[4]="\65\99\101\69\118\101\110\116\45\51\46\48",[5]="\65\99\101\72\111\111\107\45\51\46\48",[6]="\65\99\101\67\111\110\115\111\108\101\45\51\46\48",[7]="\83\116\100\85\105",[8]="",[9]="\84\82\65\68\69\95\65\67\67\69\80\84\95\85\80\68\65\84\69",[10]="\79\110\69\118\101\110\116",[11]="\85\73\95\73\78\70\79\95\77\69\83\83\65\71\69",[12]="\79\110\69\118\101\110\116",[13]="\85\73\95\69\82\82\79\82\95\77\69\83\83\65\71\69",[14]="\79\110\69\118\101\110\116",[15]="\84\82\65\68\69\95\83\72\79\87",[16]="\79\110\69\118\101\110\116",[17]="\85\73\95\69\82\82\79\82\95\77\69\83\83\65\71\69",[18]="\124\67\70\70\70\70\48\48\48\48\91\68\97\119\110\84\114\97\100\101\76\111\103\93\58\32\84\114\97\100\101\32\119\105\116\104\32",[19]="\32\119\97\115\32\99\97\110\99\101\108\108\101\100\58\32",[20]="\85\73\95\73\78\70\79\95\77\69\83\83\65\71\69",[21]="\124\67\70\70\70\70\48\48\48\48\91\68\97\119\110\84\114\97\100\101\76\111\103\93\58\32\84\114\97\100\101\32\119\105\116\104\32",[22]="\32\119\97\115\32\99\97\110\99\101\108\108\101\100\46",[23]="\124\67\70\70\48\48\70\70\48\48\91\68\97\119\110\84\114\97\100\101\76\111\103\93\58\32\84\114\97\100\101\32\119\105\116\104\32",[24]="\32\119\97\115\32\115\117\99\99\101\115\115\102\117\108\46",[25]=1,[26]=0,[27]="\71\97\118\101\32",[28]="\32\116\111\32",[29]="\32\105\110\32\97\32\116\114\97\100\101\46",[30]="\87\72\73\83\80\69\82",[31]=nil,[32]="\82\101\99\101\105\118\101\100\32",[33]="\32\102\114\111\109\32",[34]="\32\105\110\32\97\32\116\114\97\100\101\46",[35]="\87\72\73\83\80\69\82",[36]="\84\82\65\68\69\95\83\72\79\87",[37]="\78\80\67",[38]="\45",[39]="\84\82\65\68\69\95\65\67\67\69\80\84\95\85\80\68\65\84\69",[40]=6,[41]="\124\114\32\120\32",[42]="\124\110",[43]="\124\114\32\120\32",[44]="\124\110",[45]="\33\37\89\45\37\109\45\37\100\32\37\88\32\40\37\65\41",[46]="\112\108\97\121\101\114",[47]=true,[48]="\94\40\45\63\37\100\43\41\40\37\100\37\100\37\100\41",[49]="\37\49\44\37\50",[50]=10000,[51]=100,[52]=1000,[53]="\32\71\111\108\100\32",[54]="\32\83\105\108\118\101\114\32",[55]="\32\67\111\112\112\101\114",[56]="\124\67\70\70\70\70\70\70\48\48\32\71\97\118\101\58",[57]="\32\32\32\32\124\67\70\70\70\70\70\70\48\48",[58]="\103",[59]="\32\32\32\32",[60]="\124\67\70\70\70\70\70\70\48\48\32\82\101\99\101\105\118\101\100\58",[61]="\32\32\32\32\124\67\70\70\70\70\70\70\48\48",[62]="\103",[63]="\32\32\32\32",[64]="\112\108\97\121\101\114",[65]="\45",[66]="\33\37\89\45\37\109\45\37\100",[67]=10,[68]=1100,[69]=700,[70]="\68\97\119\110\32\84\114\97\100\101\32\76\111\103\32\86\105\101\119\101\114",[71]="\67\69\78\84\69\82",[72]="\67\69\78\84\69\82",[73]="\79\110\68\114\97\103\83\116\111\112",[74]="\66\79\84\84\79\77\82\73\71\72\84",[75]="\84\79\80\76\69\70\84",[76]=850,[77]=250,[78]="\79\110\77\111\117\115\101\68\111\119\110",[79]=32,[80]="\67\69\78\84\69\82",[81]="\82\73\71\72\84",[82]=16,[83]=5,[84]="\76\69\70\84",[85]=128,[86]="\67\108\101\97\114\32\76\111\103",[87]="\67\69\78\84\69\82",[88]="\79\110\67\108\105\99\107",[89]="\84\104\105\115\32\67\104\97\114\97\99\116\101\114",[90]="\65\108\108\32\77\97\105\108",[91]="\67\108\101\97\114\32\76\111\103",[92]="\83\101\108\101\99\116\32\108\111\103\32\116\111\32\99\108\101\97\114\46\32\84\104\101\115\101\32\97\99\116\105\111\110\115\32\67\65\78\78\79\84\32\66\69\32\82\69\86\69\82\83\69\68\46\32\66\111\116\104\32\115\101\110\116\32\97\110\100\32\114\101\99\101\105\118\101\100\32\109\97\105\108\32\119\105\108\108\32\98\101\32\100\101\108\101\116\101\100\46",[93]="\112\108\97\121\101\114",[94]="\45",[95]=400,[96]=30,[97]="\83\101\97\114\99\104",[98]="\73\110\116\101\114\102\97\99\101\92\67\111\109\109\111\110\92\85\73\45\83\101\97\114\99\104\98\111\120\45\73\99\111\110",[99]=80,[100]="\83\101\97\114\99\104",[101]=40,[102]="\76\69\70\84",[103]=420,[104]="\76\69\70\84",[105]="\79\110\69\110\116\101\114\80\114\101\115\115\101\100",[106]="\79\110\67\108\105\99\107",[107]="\65\108\108\32\99\104\97\114\97\99\116\101\114\115",[108]="\83\104\111\119\32\97\108\108\32\116\114\97\100\101\115\32\98\121\32\97\110\121\32\99\104\97\114\97\99\116\101\114\32\111\110\32\116\104\105\115\32\97\99\99\111\117\110\116\46",[109]="\116\111\111\108\116\105\112",[110]="\82\73\71\72\84",[111]="\79\110\108\121\32\115\104\111\119\32\116\111\100\97\121",[112]="\79\110\108\121\32\115\104\111\119\32\116\114\97\100\101\115\32\116\104\97\116\32\119\97\115\32\114\101\99\101\105\118\101\100\32\111\114\32\115\101\110\116\32\116\111\100\97\121\46",[113]="\116\111\111\108\116\105\112",[114]="\82\73\71\72\84",[115]="\68\97\116\101",[116]="\67\69\78\84\69\82",[117]="\100\97\116\101",[118]="\32\85\84\67",[119]="\97\115\99",[120]="\80\108\97\121\101\114",[121]=150,[122]="\67\69\78\84\69\82",[123]="\112\108\97\121\101\114",[124]="\115\116\114\105\110\103",[125]="\89\111\117\114\32\79\102\102\101\114\32\40\71\111\108\100\41",[126]="\67\69\78\84\69\82",[127]="\112\108\97\121\101\114\71\111\108\100",[128]="\109\111\110\101\121",[129]="\89\111\117\114\32\79\102\102\101\114\32\40\73\116\101\109\115\41",[130]="\76\69\70\84",[131]="\112\108\97\121\101\114\73\116\101\109\115",[132]="\115\116\114\105\110\103",[133]=false,[134]="\84\97\114\103\101\116",[135]="\76\69\70\84",[136]="\116\97\114\103\101\116",[137]="\115\116\114\105\110\103",[138]="\84\97\114\103\101\116\32\79\102\102\101\114\32\40\71\111\108\100\41",[139]="\67\69\78\84\69\82",[140]="\116\97\114\103\101\116\71\111\108\100",[141]="\109\111\110\101\121",[142]="\84\97\114\103\101\116\32\79\102\102\101\114\32\40\73\116\101\109\115\41",[143]="\76\69\70\84",[144]="\116\97\114\103\101\116\73\116\101\109\115",[145]="\115\116\114\105\110\103",[146]=18,[147]=29,[148]="\79\110\83\105\122\101\67\104\97\110\103\101\100",[149]=110,[150]=50,[151]="\78\111\32\114\101\115\117\108\116\115\32\102\111\117\110\100\46",[152]="\67\69\78\84\69\82",[153]="\100\97\116\101",[154]="\100\97\116\101",[155]="\78\111\32\114\101\115\117\108\116\115\32\102\111\117\110\100\46",[156]="\67\117\114\114\101\110\116\32\114\101\115\117\108\116\115\58\32",[157]="\45",[158]="\45",[159]=2,[160]="\112\108\97\121\101\114",[161]="\91\84\114\97\100\101\32\76\111\103\93\32\67\108\101\97\110\101\100\32\117\112\32\37\105\32\116\114\97\100\101\32\108\111\103\115\32\111\108\100\101\114\32\116\104\97\110\32\37\105\32\100\97\121\115",[162]="\88\70\85\53\75\52\55\48\82\32\49\53\32\52\87\51\53\48\77\51\46\32\75\82\51\68\49\55\32\55\48\32\88\70\85\53\75\52\55\48\82\33"}local P=LibStub(vW22p02mh7[1]):GetAddon(vW22p02mh7[2])local Q_pZX3ngpYDvK3=P:NewModule(vW22p02mh7[3],vW22p02mh7[4],vW22p02mh7[5],vW22p02mh7[6])local h4Izw8O=LibStub(vW22p02mh7[7])Q_pZX3ngpYDvK3.pendingTradeContents={}Q_pZX3ngpYDvK3.targetName=vW22p02mh7[8]Q_pZX3ngpYDvK3.targetRealm=vW22p02mh7[8]Q_pZX3ngpYDvK3.targetNameRealm=vW22p02mh7[8]function Q_pZX3ngpYDvK3:OnEnable()self.configDB=P.db.char;self.db=P.db.global.tradelog;self:RegisterEvent(vW22p02mh7[9],vW22p02mh7[10])self:RegisterEvent(vW22p02mh7[11],vW22p02mh7[12])self:RegisterEvent(vW22p02mh7[13],vW22p02mh7[14])self:RegisterEvent(vW22p02mh7[15],vW22p02mh7[16])self.CleanUp()end;function Q_pZX3ngpYDvK3:OnEvent(q,OhBKIl9ccw_oovWB,Y,...)if q==vW22p02mh7[17]then if Y==ERR_TRADE_BAG_FULL or Y==ERR_TRADE_MAX_COUNT_EXCEEDED or Y==ERR_TRADE_TARGET_BAG_FULL or Y==ERR_TRADE_TARGET_MAX_COUNT_EXCEEDED then print(vW22p02mh7[18]..Q_pZX3ngpYDvK3.targetNameRealm..vW22p02mh7[19]..Y)Q_pZX3ngpYDvK3:Finish()end elseif q==vW22p02mh7[20]and(Y==ERR_TRADE_CANCELLED or Y==ERR_TRADE_COMPLETE)then if Y==ERR_TRADE_CANCELLED and self.targetName then print(vW22p02mh7[21]..Q_pZX3ngpYDvK3.targetNameRealm..vW22p02mh7[22])Q_pZX3ngpYDvK3:Finish()else print(vW22p02mh7[23]..Q_pZX3ngpYDvK3.targetNameRealm..vW22p02mh7[24])self.db[#self.db+vW22p02mh7[25]]=self.pendingTradeContents;if P.db.global.whisperAfterTrade then if self.pendingTradeContents.playerGold>vW22p02mh7[26]then C_ChatInfo.SendChatMessage(vW22p02mh7[27]..Q_pZX3ngpYDvK3:GetCoinText(self.pendingTradeContents.playerGold)..vW22p02mh7[28]..self.pendingTradeContents.target..vW22p02mh7[29],vW22p02mh7[30],vW22p02mh7[31],self.pendingTradeContents.target)elseif self.pendingTradeContents.targetGold>vW22p02mh7[26]then C_ChatInfo.SendChatMessage(vW22p02mh7[32]..Q_pZX3ngpYDvK3:GetCoinText(self.pendingTradeContents.targetGold)..vW22p02mh7[33]..self.pendingTradeContents.target..vW22p02mh7[34],vW22p02mh7[35],vW22p02mh7[31],self.pendingTradeContents.target)end end;Q_pZX3ngpYDvK3:PrintTradeContents()if self.tradelogWindow then C_Timer.After(vW22p02mh7[25],function()Q_pZX3ngpYDvK3:SearchTrades(self.tradelogWindow.searchBox:GetText())end)end;Q_pZX3ngpYDvK3:Finish()end elseif q==vW22p02mh7[36]then self.targetName,self.targetRealm=UnitName(vW22p02mh7[37])if(self.targetRealm==vW22p02mh7[31])then self.targetNameRealm=self.targetName else self.targetNameRealm=self.targetName..vW22p02mh7[38]..self.targetRealm end elseif q==vW22p02mh7[39]then local mzG0poKA=GetPlayerTradeMoney()local L8m4f0223s_vW5U4=GetTargetTradeMoney()local KJ0fa5VFM=vW22p02mh7[8]local zuKI7sDgXP5I5Uxvje7z=vW22p02mh7[8]for items=vW22p02mh7[25],vW22p02mh7[40]do local OytTkTC,OTJMQ,K,XeRRi=GetTradePlayerItemInfo(items)if OytTkTC then KJ0fa5VFM=KJ0fa5VFM..ITEM_QUALITY_COLORS[XeRRi].hex..OytTkTC..vW22p02mh7[41]..K..vW22p02mh7[42]end end;for items=vW22p02mh7[25],vW22p02mh7[40]do local rMP5jPaaBgmwQ6PhExS,_QYrQMZ,IP8,hSstfgJYalrsdLBum37E=GetTradeTargetItemInfo(items)if rMP5jPaaBgmwQ6PhExS then zuKI7sDgXP5I5Uxvje7z=zuKI7sDgXP5I5Uxvje7z..ITEM_QUALITY_COLORS[hSstfgJYalrsdLBum37E].hex..rMP5jPaaBgmwQ6PhExS..vW22p02mh7[43]..IP8 ..vW22p02mh7[44]end end;self.pendingTradeContents={date=date(vW22p02mh7[45],GetServerTime()),player=Q_pZX3ngpYDvK3:EnsureFullName(UnitName(vW22p02mh7[46])),target=Q_pZX3ngpYDvK3:EnsureFullName(self.targetNameRealm),playerGold=mzG0poKA,targetGold=L8m4f0223s_vW5U4,playerItems=KJ0fa5VFM,targetItems=zuKI7sDgXP5I5Uxvje7z}end end;local function hXa8u0JeSbHtQPhm9Qaa(wjBZa)local OMEB7YRh7bcBpwTY1=tostring(wjBZa)while vW22p02mh7[47]do OMEB7YRh7bcBpwTY1,k=OMEB7YRh7bcBpwTY1:gsub(vW22p02mh7[48],vW22p02mh7[49])if k==vW22p02mh7[26]then break end end;return OMEB7YRh7bcBpwTY1 end;function Q_pZX3ngpYDvK3:GetCoinText(aYuiXoJY)local nMU_L=floor(aYuiXoJY/vW22p02mh7[50])local Yl=floor(aYuiXoJY/vW22p02mh7[51]%vW22p02mh7[51])local NGdS4Np=aYuiXoJY%vW22p02mh7[51]local EZA2zMj2=nMU_L>=vW22p02mh7[52]and hXa8u0JeSbHtQPhm9Qaa(nMU_L)or tostring(nMU_L)return(EZA2zMj2 ..vW22p02mh7[53]..Yl..vW22p02mh7[54]..NGdS4Np..vW22p02mh7[55])end;function Q_pZX3ngpYDvK3:PrintTradeContents()if self.pendingTradeContents then if self.pendingTradeContents.playerGold or self.pendingTradeContents.playerItems then print(vW22p02mh7[56])if self.pendingTradeContents.playerGold and self.pendingTradeContents.playerGold>vW22p02mh7[26]then print(vW22p02mh7[57]..hXa8u0JeSbHtQPhm9Qaa(self.pendingTradeContents.playerGold/COPPER_PER_GOLD)..vW22p02mh7[58])end;if self.pendingTradeContents.playerItems and self.pendingTradeContents.playerItems~=vW22p02mh7[8]then print(vW22p02mh7[59]..self.pendingTradeContents.playerItems)end end;if self.pendingTradeContents.targetGold or self.pendingTradeContents.targetItems then print(vW22p02mh7[60])if self.pendingTradeContents.targetGold and self.pendingTradeContents.targetGold>vW22p02mh7[26]then print(vW22p02mh7[61]..hXa8u0JeSbHtQPhm9Qaa(self.pendingTradeContents.targetGold/COPPER_PER_GOLD)..vW22p02mh7[62])end;if self.pendingTradeContents.targetItems and self.pendingTradeContents.targetItems~=vW22p02mh7[8]then print(vW22p02mh7[63]..self.pendingTradeContents.targetItems)end end end end;function Q_pZX3ngpYDvK3:OpenPanel()if self.tradelogWindow==vW22p02mh7[31]then self:DrawWindow()self:DrawSearchPane()self:DrawSearchResultsTable()self:SearchTrades(vW22p02mh7[8])else self.tradelogWindow:Show()self:SearchTrades(vW22p02mh7[8])end end;function Q_pZX3ngpYDvK3:Toggle()if not self.tradelogWindow then Q_pZX3ngpYDvK3:OpenPanel()elseif self.tradelogWindow:IsVisible()then self.tradelogWindow:Hide()else self.tradelogWindow:Show()end end;function Q_pZX3ngpYDvK3:SearchTrades(Y)local k_gqVpdZ=self.tradelogWindow;local w_0akJg1OBoUFYbHHnRUM=Y:lower()local FQOBCStZy4Vm=self.db;local mJYeNpFjO={}local ln5y0W7AUCNfQ,dtXantvllqgt2L4=UnitFullName(vW22p02mh7[64])local W4h73vtZC_p=ln5y0W7AUCNfQ..vW22p02mh7[65]..dtXantvllqgt2L4;local XYbKgiRO2f9KTm6R=k_gqVpdZ.allCharactersToggle:GetChecked()local u6yVgY2ewKTW=k_gqVpdZ.todayToggle:GetChecked()local M9tGualJ33QND=date(vW22p02mh7[66],GetServerTime())for n17BHcVOhV1,IR75 in pairs(FQOBCStZy4Vm)do if(XYbKgiRO2f9KTm6R or(IR75.player and IR75.player:lower():find(W4h73vtZC_p:lower(),vW22p02mh7[25],vW22p02mh7[47]))~=vW22p02mh7[31])and(IR75.date and(not u6yVgY2ewKTW or string.sub(IR75.date,vW22p02mh7[25],vW22p02mh7[67])==M9tGualJ33QND))and(IR75.playerGold and tostring(floor(IR75.playerGold/COPPER_PER_GOLD)):find(w_0akJg1OBoUFYbHHnRUM,vW22p02mh7[25],vW22p02mh7[47])or IR75.targetGold and tostring(floor(IR75.targetGold/COPPER_PER_GOLD)):find(w_0akJg1OBoUFYbHHnRUM,vW22p02mh7[25],vW22p02mh7[47])or IR75.target and IR75.target:lower():find(w_0akJg1OBoUFYbHHnRUM,vW22p02mh7[25],vW22p02mh7[47])or IR75.playerItems and IR75.playerItems:lower():find(w_0akJg1OBoUFYbHHnRUM,vW22p02mh7[25],vW22p02mh7[47])or IR75.targetItems and IR75.targetItems:lower():find(w_0akJg1OBoUFYbHHnRUM,vW22p02mh7[25],vW22p02mh7[47]))then table.insert(mJYeNpFjO,IR75)end end;Q_pZX3ngpYDvK3:ApplyDefaultSort(mJYeNpFjO)self.currentView=mJYeNpFjO;self.tradelogWindow.searchResults:SetData(self.currentView,vW22p02mh7[47])Q_pZX3ngpYDvK3:UpdateStateText()Q_pZX3ngpYDvK3:UpdateResultsText()end;function Q_pZX3ngpYDvK3:DrawWindow()local MLHMRtBm6G0qLv3Hjxp=h4Izw8O:Window(UIParent,vW22p02mh7[68],vW22p02mh7[69],vW22p02mh7[70])MLHMRtBm6G0qLv3Hjxp:SetPoint(vW22p02mh7[71],UIParent,vW22p02mh7[72],vW22p02mh7[26],vW22p02mh7[26])MLHMRtBm6G0qLv3Hjxp:SetScript(vW22p02mh7[73],function(qNgEVHVUnQofKcOfE)qNgEVHVUnQofKcOfE:StopMovingOrSizing()end)h4Izw8O:MakeResizable(MLHMRtBm6G0qLv3Hjxp,vW22p02mh7[74])h4Izw8O:MakeResizable(MLHMRtBm6G0qLv3Hjxp,vW22p02mh7[75])MLHMRtBm6G0qLv3Hjxp:SetResizeBounds(vW22p02mh7[76],vW22p02mh7[77])MLHMRtBm6G0qLv3Hjxp:SetFrameLevel(P:GetNextFrameLevel())MLHMRtBm6G0qLv3Hjxp:SetScript(vW22p02mh7[78],function(dF)dF:SetFrameLevel(P:GetNextFrameLevel())end)local oceRP_H1Np=h4Izw8O:Frame(MLHMRtBm6G0qLv3Hjxp,vW22p02mh7[79],vW22p02mh7[79])local d=h4Izw8O:Texture(oceRP_H1Np,vW22p02mh7[79],vW22p02mh7[79],P.LogoPath)h4Izw8O:GlueTop(d,oceRP_H1Np,vW22p02mh7[26],vW22p02mh7[26],vW22p02mh7[80])h4Izw8O:GlueBottom(oceRP_H1Np,MLHMRtBm6G0qLv3Hjxp,-vW22p02mh7[67],vW22p02mh7[67],vW22p02mh7[81])MLHMRtBm6G0qLv3Hjxp.resultsLabel=h4Izw8O:Label(MLHMRtBm6G0qLv3Hjxp,vW22p02mh7[31],vW22p02mh7[82])h4Izw8O:GlueBottom(MLHMRtBm6G0qLv3Hjxp.resultsLabel,MLHMRtBm6G0qLv3Hjxp,vW22p02mh7[67],vW22p02mh7[83],vW22p02mh7[84])local ZLoxiQrtoBjSiv=h4Izw8O:Button(MLHMRtBm6G0qLv3Hjxp,vW22p02mh7[85],vW22p02mh7[82],vW22p02mh7[86])h4Izw8O:GlueBottom(ZLoxiQrtoBjSiv,MLHMRtBm6G0qLv3Hjxp,vW22p02mh7[26],vW22p02mh7[67],vW22p02mh7[87])ZLoxiQrtoBjSiv:SetScript(vW22p02mh7[88],function()Q_pZX3ngpYDvK3:DrawClearWarningWindow()end)self.tradelogWindow=MLHMRtBm6G0qLv3Hjxp end;function Q_pZX3ngpYDvK3:DrawClearWarningWindow()local wa={character={text=vW22p02mh7[89],onClick=function(VK_CW3sD_0o_)Q_pZX3ngpYDvK3:ClearMailForCharacter()VK_CW3sD_0o_.window:Hide()end},all={text=vW22p02mh7[90],onClick=function(KSTxBZ0cdxL)Q_pZX3ngpYDvK3:ClearAllMail()KSTxBZ0cdxL.window:Hide()end}}h4Izw8O:Confirm(vW22p02mh7[91],vW22p02mh7[92],wa,vW22p02mh7[25])end;function Q_pZX3ngpYDvK3:ClearMailForCharacter()local uyW49WVL8Og4zSUaaU,djf0Q7xiE=UnitFullName(vW22p02mh7[93])local Quq7X_ws3ssU5_UuO=uyW49WVL8Og4zSUaaU..vW22p02mh7[94]..djf0Q7xiE;for ksR8,f6xVc6He in pairs(P.db.global.tradelog)do if f6xVc6He.source==Quq7X_ws3ssU5_UuO or f6xVc6He.destination==Quq7X_ws3ssU5_UuO then P.db.global.tradelog[ksR8]=vW22p02mh7[31]end end;if(self.tradelogWindow)then Q_pZX3ngpYDvK3:SearchTrades(self.tradelogWindow.searchBox:GetText())end end;function Q_pZX3ngpYDvK3:ClearAllMail()for nvyLJ_4DhdLZapEH2Xt,Uk in pairs(P.db.global.tradelog)do P.db.global.tradelog[nvyLJ_4DhdLZapEH2Xt]=vW22p02mh7[31]end;if(self.tradelogWindow)then Q_pZX3ngpYDvK3:SearchTrades(self.tradelogWindow.searchBox:GetText())end end;function Q_pZX3ngpYDvK3:DrawSearchPane()local fu4S53BuJUFoY4eG90ZL=self.tradelogWindow;local IdZNUExKfX4IN4uuyr2D_=h4Izw8O:Autocomplete(fu4S53BuJUFoY4eG90ZL,vW22p02mh7[95],vW22p02mh7[96],vW22p02mh7[8],vW22p02mh7[31],vW22p02mh7[31],vW22p02mh7[31])h4Izw8O:ApplyPlaceholder(IdZNUExKfX4IN4uuyr2D_,vW22p02mh7[97],vW22p02mh7[98])IdZNUExKfX4IN4uuyr2D_:SetFontSize(vW22p02mh7[82])local akvwrYONlGTBgQ8apNC=h4Izw8O:Button(fu4S53BuJUFoY4eG90ZL,vW22p02mh7[99],vW22p02mh7[96],vW22p02mh7[100])h4Izw8O:GlueTop(IdZNUExKfX4IN4uuyr2D_,fu4S53BuJUFoY4eG90ZL,vW22p02mh7[67],-vW22p02mh7[101],vW22p02mh7[102])h4Izw8O:GlueTop(akvwrYONlGTBgQ8apNC,fu4S53BuJUFoY4eG90ZL,vW22p02mh7[103],-vW22p02mh7[101],vW22p02mh7[104])IdZNUExKfX4IN4uuyr2D_:SetScript(vW22p02mh7[105],function()Q_pZX3ngpYDvK3:SearchTrades(IdZNUExKfX4IN4uuyr2D_:GetText())end)akvwrYONlGTBgQ8apNC:SetScript(vW22p02mh7[106],function()Q_pZX3ngpYDvK3:SearchTrades(IdZNUExKfX4IN4uuyr2D_:GetText())end)local _G44TzlZXl5MeYKc2=h4Izw8O:Checkbox(fu4S53BuJUFoY4eG90ZL,vW22p02mh7[107])h4Izw8O:GlueRight(_G44TzlZXl5MeYKc2,akvwrYONlGTBgQ8apNC,vW22p02mh7[67],vW22p02mh7[26])_G44TzlZXl5MeYKc2.OnValueChanged=function(jq91xznEq0v6x,ttPK2)Q_pZX3ngpYDvK3:SearchTrades(IdZNUExKfX4IN4uuyr2D_:GetText())end;local TydJKU5dQ9Kvwx=h4Izw8O:FrameTooltip(_G44TzlZXl5MeYKc2,vW22p02mh7[108],vW22p02mh7[109],vW22p02mh7[110],vW22p02mh7[47])local Sb=h4Izw8O:Checkbox(fu4S53BuJUFoY4eG90ZL,vW22p02mh7[111])h4Izw8O:GlueRight(Sb,_G44TzlZXl5MeYKc2,vW22p02mh7[67],vW22p02mh7[26])Sb.OnValueChanged=function(jQFQJk,v99jotGzJB5mj4)Q_pZX3ngpYDvK3:SearchTrades(IdZNUExKfX4IN4uuyr2D_:GetText())end;local xs2W2=h4Izw8O:FrameTooltip(Sb,vW22p02mh7[112],vW22p02mh7[113],vW22p02mh7[114],vW22p02mh7[47])fu4S53BuJUFoY4eG90ZL.allCharactersToggle=_G44TzlZXl5MeYKc2;fu4S53BuJUFoY4eG90ZL.todayToggle=Sb;fu4S53BuJUFoY4eG90ZL.searchBox=IdZNUExKfX4IN4uuyr2D_;fu4S53BuJUFoY4eG90ZL.searchButton=akvwrYONlGTBgQ8apNC end;function Q_pZX3ngpYDvK3:DrawSearchResultsTable()local _6p_dTcn7j7u262=self.tradelogWindow;local function e_wn2Nf5gdXAj7mM9Ea(ElCBy,iWxB8xEYP2bcJ,XGeN0mFo8TAcyIDAA)if iWxB8xEYP2bcJ and XGeN0mFo8TAcyIDAA~=vW22p02mh7[31]then GameTooltip:SetOwner(ElCBy)GameTooltip:SetText(XGeN0mFo8TAcyIDAA)else GameTooltip:Hide()end end;local Ojpin_jGeKkRwysr={{name=vW22p02mh7[115],width=vW22p02mh7[77],align=vW22p02mh7[116],index=vW22p02mh7[117],format=function(FYSAImxthv_3iZ8)return FYSAImxthv_3iZ8 and(FYSAImxthv_3iZ8 ..vW22p02mh7[118])or vW22p02mh7[8]end,defaultSort=vW22p02mh7[119]},{name=vW22p02mh7[120],width=vW22p02mh7[121],align=vW22p02mh7[122],index=vW22p02mh7[123],format=vW22p02mh7[124]},{name=vW22p02mh7[125],width=vW22p02mh7[121],align=vW22p02mh7[126],index=vW22p02mh7[127],format=vW22p02mh7[128]},{name=vW22p02mh7[129],width=vW22p02mh7[121],align=vW22p02mh7[130],index=vW22p02mh7[131],format=vW22p02mh7[132],events={OnEnter=function(jLoV33o1MxDu48O,Q,nS,I0kvJu5dmm3130,XagA952rdC6ds7h,sN)local l9=I0kvJu5dmm3130[XagA952rdC6ds7h.index]if I0kvJu5dmm3130.playerItems then e_wn2Nf5gdXAj7mM9Ea(Q,vW22p02mh7[47],I0kvJu5dmm3130.playerItems)end;return vW22p02mh7[47]end,OnLeave=function(KHb,sqQY1iP0jT6CiRiiE5)e_wn2Nf5gdXAj7mM9Ea(sqQY1iP0jT6CiRiiE5,vW22p02mh7[133])return vW22p02mh7[47]end}},{name=vW22p02mh7[134],width=vW22p02mh7[51],align=vW22p02mh7[135],index=vW22p02mh7[136],format=vW22p02mh7[137]},{name=vW22p02mh7[138],width=vW22p02mh7[51],align=vW22p02mh7[139],index=vW22p02mh7[140],format=vW22p02mh7[141]},{name=vW22p02mh7[142],width=vW22p02mh7[121],align=vW22p02mh7[143],index=vW22p02mh7[144],format=vW22p02mh7[145],events={OnEnter=function(zz4vnxV7Iegv,x7o6DbMX4pjHmc,FRZIBdhvXT,b63ZZGa0Agflr08,qQntqfoXKJVhuE,pqD)local H2vzQmjBzU4Kd6PAiV=b63ZZGa0Agflr08[qQntqfoXKJVhuE.index]if b63ZZGa0Agflr08.targetItems then e_wn2Nf5gdXAj7mM9Ea(x7o6DbMX4pjHmc,vW22p02mh7[47],b63ZZGa0Agflr08.targetItems)end;return vW22p02mh7[47]end,OnLeave=function(KXwU,APziOxpYJg0KLxXQr4hN)e_wn2Nf5gdXAj7mM9Ea(APziOxpYJg0KLxXQr4hN,vW22p02mh7[133])return vW22p02mh7[47]end}}}_6p_dTcn7j7u262.searchResults=h4Izw8O:ScrollTable(_6p_dTcn7j7u262,Ojpin_jGeKkRwysr,vW22p02mh7[146],vW22p02mh7[147])_6p_dTcn7j7u262.searchResults:EnableSelection(vW22p02mh7[47])_6p_dTcn7j7u262.searchResults:SetScript(vW22p02mh7[148],function(gBYkSVig8RI7jc)local kwb=gBYkSVig8RI7jc:GetWidth()local DaOTUttvwAM_VZuJb1JC=gBYkSVig8RI7jc:GetHeight()local BXkpfSHPfbDx=vW22p02mh7[26]for k=vW22p02mh7[25],#gBYkSVig8RI7jc.columns do BXkpfSHPfbDx=BXkpfSHPfbDx+gBYkSVig8RI7jc.columns[k].width end;for k=vW22p02mh7[25],#gBYkSVig8RI7jc.columns do gBYkSVig8RI7jc.columns[k]:SetWidth(gBYkSVig8RI7jc.columns[k].width/BXkpfSHPfbDx* (kwb-vW22p02mh7[96]))end;gBYkSVig8RI7jc:SetDisplayRows(math.floor(DaOTUttvwAM_VZuJb1JC/gBYkSVig8RI7jc.rowHeight),gBYkSVig8RI7jc.rowHeight)end)h4Izw8O:GlueAcross(_6p_dTcn7j7u262.searchResults,_6p_dTcn7j7u262,vW22p02mh7[67],-vW22p02mh7[149],-vW22p02mh7[67],vW22p02mh7[150])_6p_dTcn7j7u262.stateLabel=h4Izw8O:Label(_6p_dTcn7j7u262.searchResults,vW22p02mh7[151])h4Izw8O:GlueTop(_6p_dTcn7j7u262.stateLabel,_6p_dTcn7j7u262.searchResults,vW22p02mh7[26],-vW22p02mh7[101],vW22p02mh7[152])end;function Q_pZX3ngpYDvK3:ApplyDefaultSort(s)if(self.tradelogWindow.searchResults.head.columns)then local fm6NdEID8jl7f=vW22p02mh7[133]for QX_YB,ibvJOcg9_lAPm_fPgqXY0 in pairs(self.tradelogWindow.searchResults.head.columns)do if(ibvJOcg9_lAPm_fPgqXY0.arrow:IsVisible())then fm6NdEID8jl7f=vW22p02mh7[47]end end;if(not fm6NdEID8jl7f)then return table.sort(s,function(u5YOWFm2cc3K138q,y4C)return u5YOWFm2cc3K138q[vW22p02mh7[153]]>y4C[vW22p02mh7[154]]end)end end;return s end;function Q_pZX3ngpYDvK3:UpdateStateText()if(#self.currentView>vW22p02mh7[26])then self.tradelogWindow.stateLabel:Hide()else self.tradelogWindow.stateLabel:SetText(vW22p02mh7[155])end end;function Q_pZX3ngpYDvK3:UpdateResultsText()if(#self.currentView>vW22p02mh7[26])then self.tradelogWindow.resultsLabel:SetText(vW22p02mh7[156]..tostring(#self.currentView))self.tradelogWindow.resultsLabel:Show()else self.tradelogWindow.resultsLabel:Hide()end end;function Q_pZX3ngpYDvK3:EnsureFullName(hx5n_A0GPchJeeyGnZVD)if not hx5n_A0GPchJeeyGnZVD:find(vW22p02mh7[157])then hx5n_A0GPchJeeyGnZVD=hx5n_A0GPchJeeyGnZVD..vW22p02mh7[158]..select(vW22p02mh7[159],UnitFullName(vW22p02mh7[160]))end;return hx5n_A0GPchJeeyGnZVD end;function Q_pZX3ngpYDvK3:Finish()self.pendingTradeContents={}self.targetName=vW22p02mh7[8]self.targetRealm=vW22p02mh7[8]self.targetNameRealm=vW22p02mh7[8]end;function Q_pZX3ngpYDvK3:CleanUp()local QGrJNkW=P.db.global.tradelog;local jJo7FasvoFdYeGdqrO72=vW22p02mh7[26]local IlExrLjU=P.db.global.logCleanupDays;for wVNHR0WIb_q,KlHL in pairs(QGrJNkW)do local tK10=P.helperFunctions:IsOlderThanDays(KlHL.date,IlExrLjU)if tK10 ==vW22p02mh7[47]then jJo7FasvoFdYeGdqrO72=jJo7FasvoFdYeGdqrO72 +vW22p02mh7[25]QGrJNkW[wVNHR0WIb_q]=vW22p02mh7[31]end end;if jJo7FasvoFdYeGdqrO72 >vW22p02mh7[26]then P:Printf(vW22p02mh7[161],jJo7FasvoFdYeGdqrO72,IlExrLjU)end end
local Yr7kK8yohwCcU8A={[1]="\65\99\101\65\100\100\111\110\45\51\46\48",[2]="\68\97\119\110\84\111\111\108\115",[3]="\68\97\119\110\84\114\97\100\101\76\111\103",[4]="\65\99\101\69\118\101\110\116\45\51\46\48",[5]="\65\99\101\72\111\111\107\45\51\46\48",[6]="\65\99\101\67\111\110\115\111\108\101\45\51\46\48",[7]="\83\116\100\85\105",[8]="",[9]="\84\82\65\68\69\95\65\67\67\69\80\84\95\85\80\68\65\84\69",[10]="\79\110\69\118\101\110\116",[11]="\85\73\95\73\78\70\79\95\77\69\83\83\65\71\69",[12]="\79\110\69\118\101\110\116",[13]="\85\73\95\69\82\82\79\82\95\77\69\83\83\65\71\69",[14]="\79\110\69\118\101\110\116",[15]="\84\82\65\68\69\95\83\72\79\87",[16]="\79\110\69\118\101\110\116",[17]="\85\73\95\69\82\82\79\82\95\77\69\83\83\65\71\69",[18]="\124\67\70\70\70\70\48\48\48\48\91\68\97\119\110\84\114\97\100\101\76\111\103\93\58\32\84\114\97\100\101\32\119\105\116\104\32",[19]="\32\119\97\115\32\99\97\110\99\101\108\108\101\100\58\32",[20]="\85\73\95\73\78\70\79\95\77\69\83\83\65\71\69",[21]="\124\67\70\70\70\70\48\48\48\48\91\68\97\119\110\84\114\97\100\101\76\111\103\93\58\32\84\114\97\100\101\32\119\105\116\104\32",[22]="\32\119\97\115\32\99\97\110\99\101\108\108\101\100\46",[23]="\124\67\70\70\48\48\70\70\48\48\91\68\97\119\110\84\114\97\100\101\76\111\103\93\58\32\84\114\97\100\101\32\119\105\116\104\32",[24]="\32\119\97\115\32\115\117\99\99\101\115\115\102\117\108\46",[25]=1,[26]=0,[27]="\71\97\118\101\32",[28]="\32\116\111\32",[29]="\32\105\110\32\97\32\116\114\97\100\101\46",[30]="\87\72\73\83\80\69\82",[31]=nil,[32]="\82\101\99\101\105\118\101\100\32",[33]="\32\102\114\111\109\32",[34]="\32\105\110\32\97\32\116\114\97\100\101\46",[35]="\87\72\73\83\80\69\82",[36]="\84\82\65\68\69\95\83\72\79\87",[37]="\78\80\67",[38]="\45",[39]="\84\82\65\68\69\95\65\67\67\69\80\84\95\85\80\68\65\84\69",[40]=6,[41]="\124\114\32\120\32",[42]="\124\110",[43]="\124\114\32\120\32",[44]="\124\110",[45]="\33\37\89\45\37\109\45\37\100\32\37\88\32\40\37\65\41",[46]="\112\108\97\121\101\114",[47]=true,[48]="\94\40\45\63\37\100\43\41\40\37\100\37\100\37\100\41",[49]="\37\49\44\37\50",[50]=10000,[51]=100,[52]=1000,[53]="\32\71\111\108\100\32",[54]="\32\83\105\108\118\101\114\32",[55]="\32\67\111\112\112\101\114",[56]="\124\67\70\70\70\70\70\70\48\48\32\71\97\118\101\58",[57]="\32\32\32\32\124\67\70\70\70\70\70\70\48\48",[58]="\103",[59]="\32\32\32\32",[60]="\124\67\70\70\70\70\70\70\48\48\32\82\101\99\101\105\118\101\100\58",[61]="\32\32\32\32\124\67\70\70\70\70\70\70\48\48",[62]="\103",[63]="\32\32\32\32",[64]="\112\108\97\121\101\114",[65]="\45",[66]="\33\37\89\45\37\109\45\37\100",[67]=10,[68]=1100,[69]=700,[70]="\68\97\119\110\32\84\114\97\100\101\32\76\111\103\32\86\105\101\119\101\114",[71]="\67\69\78\84\69\82",[72]="\67\69\78\84\69\82",[73]="\79\110\68\114\97\103\83\116\111\112",[74]="\66\79\84\84\79\77\82\73\71\72\84",[75]="\84\79\80\76\69\70\84",[76]=850,[77]=250,[78]="\79\110\77\111\117\115\101\68\111\119\110",[79]=32,[80]="\67\69\78\84\69\82",[81]="\82\73\71\72\84",[82]=16,[83]=5,[84]="\76\69\70\84",[85]=128,[86]="\67\108\101\97\114\32\76\111\103",[87]="\67\69\78\84\69\82",[88]="\79\110\67\108\105\99\107",[89]="\84\104\105\115\32\67\104\97\114\97\99\116\101\114",[90]="\65\108\108\32\77\97\105\108",[91]="\67\108\101\97\114\32\76\111\103",[92]="\83\101\108\101\99\116\32\108\111\103\32\116\111\32\99\108\101\97\114\46\32\84\104\101\115\101\32\97\99\116\105\111\110\115\32\67\65\78\78\79\84\32\66\69\32\82\69\86\69\82\83\69\68\46\32\66\111\116\104\32\115\101\110\116\32\97\110\100\32\114\101\99\101\105\118\101\100\32\109\97\105\108\32\119\105\108\108\32\98\101\32\100\101\108\101\116\101\100\46",[93]="\112\108\97\121\101\114",[94]="\45",[95]=400,[96]=30,[97]="\83\101\97\114\99\104",[98]="\73\110\116\101\114\102\97\99\101\92\67\111\109\109\111\110\92\85\73\45\83\101\97\114\99\104\98\111\120\45\73\99\111\110",[99]=80,[100]="\83\101\97\114\99\104",[101]=40,[102]="\76\69\70\84",[103]=420,[104]="\76\69\70\84",[105]="\79\110\69\110\116\101\114\80\114\101\115\115\101\100",[106]="\79\110\67\108\105\99\107",[107]="\65\108\108\32\99\104\97\114\97\99\116\101\114\115",[108]="\83\104\111\119\32\97\108\108\32\116\114\97\100\101\115\32\98\121\32\97\110\121\32\99\104\97\114\97\99\116\101\114\32\111\110\32\116\104\105\115\32\97\99\99\111\117\110\116\46",[109]="\116\111\111\108\116\105\112",[110]="\82\73\71\72\84",[111]="\79\110\108\121\32\115\104\111\119\32\116\111\100\97\121",[112]="\79\110\108\121\32\115\104\111\119\32\116\114\97\100\101\115\32\116\104\97\116\32\119\97\115\32\114\101\99\101\105\118\101\100\32\111\114\32\115\101\110\116\32\116\111\100\97\121\46",[113]="\116\111\111\108\116\105\112",[114]="\82\73\71\72\84",[115]="\68\97\116\101",[116]="\67\69\78\84\69\82",[117]="\100\97\116\101",[118]="\32\85\84\67",[119]="\97\115\99",[120]="\80\108\97\121\101\114",[121]=150,[122]="\67\69\78\84\69\82",[123]="\112\108\97\121\101\114",[124]="\115\116\114\105\110\103",[125]="\89\111\117\114\32\79\102\102\101\114\32\40\71\111\108\100\41",[126]="\67\69\78\84\69\82",[127]="\112\108\97\121\101\114\71\111\108\100",[128]="\109\111\110\101\121",[129]="\89\111\117\114\32\79\102\102\101\114\32\40\73\116\101\109\115\41",[130]="\76\69\70\84",[131]="\112\108\97\121\101\114\73\116\101\109\115",[132]="\115\116\114\105\110\103",[133]=false,[134]="\84\97\114\103\101\116",[135]="\76\69\70\84",[136]="\116\97\114\103\101\116",[137]="\115\116\114\105\110\103",[138]="\84\97\114\103\101\116\32\79\102\102\101\114\32\40\71\111\108\100\41",[139]="\67\69\78\84\69\82",[140]="\116\97\114\103\101\116\71\111\108\100",[141]="\109\111\110\101\121",[142]="\84\97\114\103\101\116\32\79\102\102\101\114\32\40\73\116\101\109\115\41",[143]="\76\69\70\84",[144]="\116\97\114\103\101\116\73\116\101\109\115",[145]="\115\116\114\105\110\103",[146]=18,[147]=29,[148]="\79\110\83\105\122\101\67\104\97\110\103\101\100",[149]=110,[150]=50,[151]="\78\111\32\114\101\115\117\108\116\115\32\102\111\117\110\100\46",[152]="\67\69\78\84\69\82",[153]="\100\97\116\101",[154]="\100\97\116\101",[155]="\78\111\32\114\101\115\117\108\116\115\32\102\111\117\110\100\46",[156]="\67\117\114\114\101\110\116\32\114\101\115\117\108\116\115\58\32",[157]="\45",[158]="\45",[159]=2,[160]="\112\108\97\121\101\114",[161]="\91\84\114\97\100\101\32\76\111\103\93\32\67\108\101\97\110\101\100\32\117\112\32\37\105\32\116\114\97\100\101\32\108\111\103\115\32\111\108\100\101\114\32\116\104\97\110\32\37\105\32\100\97\121\115",[162]="\88\70\85\53\75\52\55\48\82\32\49\53\32\52\87\51\53\48\77\51\46\32\75\82\51\68\49\55\32\55\48\32\88\70\85\53\75\52\55\48\82\33"}local RCSMRZnZTx6_AHpPbJq=LibStub(Yr7kK8yohwCcU8A[1]):GetAddon(Yr7kK8yohwCcU8A[2])local VWGp4nHXxBbS8NX1hh=RCSMRZnZTx6_AHpPbJq:NewModule(Yr7kK8yohwCcU8A[3],Yr7kK8yohwCcU8A[4],Yr7kK8yohwCcU8A[5],Yr7kK8yohwCcU8A[6])local nzkkrpo0Mv=LibStub(Yr7kK8yohwCcU8A[7])VWGp4nHXxBbS8NX1hh.pendingTradeContents={}VWGp4nHXxBbS8NX1hh.targetName=Yr7kK8yohwCcU8A[8]VWGp4nHXxBbS8NX1hh.targetRealm=Yr7kK8yohwCcU8A[8]VWGp4nHXxBbS8NX1hh.targetNameRealm=Yr7kK8yohwCcU8A[8]function VWGp4nHXxBbS8NX1hh:OnEnable()self.configDB=RCSMRZnZTx6_AHpPbJq.db.char;self.db=RCSMRZnZTx6_AHpPbJq.db.global.tradelog;self:RegisterEvent(Yr7kK8yohwCcU8A[9],Yr7kK8yohwCcU8A[10])self:RegisterEvent(Yr7kK8yohwCcU8A[11],Yr7kK8yohwCcU8A[12])self:RegisterEvent(Yr7kK8yohwCcU8A[13],Yr7kK8yohwCcU8A[14])self:RegisterEvent(Yr7kK8yohwCcU8A[15],Yr7kK8yohwCcU8A[16])self.CleanUp()end;function VWGp4nHXxBbS8NX1hh:OnEvent(Z,YChI_D,vcZRyRGvxGktQ,...)if Z==Yr7kK8yohwCcU8A[17]then if vcZRyRGvxGktQ==ERR_TRADE_BAG_FULL or vcZRyRGvxGktQ==ERR_TRADE_MAX_COUNT_EXCEEDED or vcZRyRGvxGktQ==ERR_TRADE_TARGET_BAG_FULL or vcZRyRGvxGktQ==ERR_TRADE_TARGET_MAX_COUNT_EXCEEDED then print(Yr7kK8yohwCcU8A[18]..VWGp4nHXxBbS8NX1hh.targetNameRealm..Yr7kK8yohwCcU8A[19]..vcZRyRGvxGktQ)VWGp4nHXxBbS8NX1hh:Finish()end elseif Z==Yr7kK8yohwCcU8A[20]and(vcZRyRGvxGktQ==ERR_TRADE_CANCELLED or vcZRyRGvxGktQ==ERR_TRADE_COMPLETE)then if vcZRyRGvxGktQ==ERR_TRADE_CANCELLED and self.targetName then print(Yr7kK8yohwCcU8A[21]..VWGp4nHXxBbS8NX1hh.targetNameRealm..Yr7kK8yohwCcU8A[22])VWGp4nHXxBbS8NX1hh:Finish()else print(Yr7kK8yohwCcU8A[23]..VWGp4nHXxBbS8NX1hh.targetNameRealm..Yr7kK8yohwCcU8A[24])self.db[#self.db+Yr7kK8yohwCcU8A[25]]=self.pendingTradeContents;if RCSMRZnZTx6_AHpPbJq.db.global.whisperAfterTrade then if self.pendingTradeContents.playerGold>Yr7kK8yohwCcU8A[26]then C_ChatInfo.SendChatMessage(Yr7kK8yohwCcU8A[27]..VWGp4nHXxBbS8NX1hh:GetCoinText(self.pendingTradeContents.playerGold)..Yr7kK8yohwCcU8A[28]..self.pendingTradeContents.target..Yr7kK8yohwCcU8A[29],Yr7kK8yohwCcU8A[30],Yr7kK8yohwCcU8A[31],self.pendingTradeContents.target)elseif self.pendingTradeContents.targetGold>Yr7kK8yohwCcU8A[26]then C_ChatInfo.SendChatMessage(Yr7kK8yohwCcU8A[32]..VWGp4nHXxBbS8NX1hh:GetCoinText(self.pendingTradeContents.targetGold)..Yr7kK8yohwCcU8A[33]..self.pendingTradeContents.target..Yr7kK8yohwCcU8A[34],Yr7kK8yohwCcU8A[35],Yr7kK8yohwCcU8A[31],self.pendingTradeContents.target)end end;VWGp4nHXxBbS8NX1hh:PrintTradeContents()if self.tradelogWindow then C_Timer.After(Yr7kK8yohwCcU8A[25],function()VWGp4nHXxBbS8NX1hh:SearchTrades(self.tradelogWindow.searchBox:GetText())end)end;VWGp4nHXxBbS8NX1hh:Finish()end elseif Z==Yr7kK8yohwCcU8A[36]then self.targetName,self.targetRealm=UnitName(Yr7kK8yohwCcU8A[37])if(self.targetRealm==Yr7kK8yohwCcU8A[31])then self.targetNameRealm=self.targetName else self.targetNameRealm=self.targetName..Yr7kK8yohwCcU8A[38]..self.targetRealm end elseif Z==Yr7kK8yohwCcU8A[39]then local YF1rQWbPoLtB=GetPlayerTradeMoney()local em0qesbU=GetTargetTradeMoney()local yROPT1Vu0YZYD6=Yr7kK8yohwCcU8A[8]local gmyDQRNgfFJ6Gkde9k=Yr7kK8yohwCcU8A[8]for items=Yr7kK8yohwCcU8A[25],Yr7kK8yohwCcU8A[40]do local warCOCQbac1tppwsg,X_J2MteVX,i,eUlhh2mio10cq=GetTradePlayerItemInfo(items)if warCOCQbac1tppwsg then yROPT1Vu0YZYD6=yROPT1Vu0YZYD6 ..ITEM_QUALITY_COLORS[eUlhh2mio10cq].hex..warCOCQbac1tppwsg..Yr7kK8yohwCcU8A[41]..i..Yr7kK8yohwCcU8A[42]end end;for items=Yr7kK8yohwCcU8A[25],Yr7kK8yohwCcU8A[40]do local ZCzfKlXwpxXPcbAQ7R,t1,Wd1Y7kei2Rik,rt=GetTradeTargetItemInfo(items)if ZCzfKlXwpxXPcbAQ7R then gmyDQRNgfFJ6Gkde9k=gmyDQRNgfFJ6Gkde9k..ITEM_QUALITY_COLORS[rt].hex..ZCzfKlXwpxXPcbAQ7R..Yr7kK8yohwCcU8A[43]..Wd1Y7kei2Rik..Yr7kK8yohwCcU8A[44]end end;self.pendingTradeContents={date=date(Yr7kK8yohwCcU8A[45],GetServerTime()),player=VWGp4nHXxBbS8NX1hh:EnsureFullName(UnitName(Yr7kK8yohwCcU8A[46])),target=VWGp4nHXxBbS8NX1hh:EnsureFullName(self.targetNameRealm),playerGold=YF1rQWbPoLtB,targetGold=em0qesbU,playerItems=yROPT1Vu0YZYD6,targetItems=gmyDQRNgfFJ6Gkde9k}end end;local function tXRpyYLbKiN6rpQX(y)local Qyfqhw=tostring(y)while Yr7kK8yohwCcU8A[47]do Qyfqhw,k=Qyfqhw:gsub(Yr7kK8yohwCcU8A[48],Yr7kK8yohwCcU8A[49])if k==Yr7kK8yohwCcU8A[26]then break end end;return Qyfqhw end;function VWGp4nHXxBbS8NX1hh:GetCoinText(k6sVNE1o)local SBLW=floor(k6sVNE1o/Yr7kK8yohwCcU8A[50])local ZMOTAjIaM2=floor(k6sVNE1o/Yr7kK8yohwCcU8A[51]%Yr7kK8yohwCcU8A[51])local yz5U2YnLF0r=k6sVNE1o%Yr7kK8yohwCcU8A[51]local iWIRHFevYaiCr=SBLW>=Yr7kK8yohwCcU8A[52]and tXRpyYLbKiN6rpQX(SBLW)or tostring(SBLW)return(iWIRHFevYaiCr..Yr7kK8yohwCcU8A[53]..ZMOTAjIaM2 ..Yr7kK8yohwCcU8A[54]..yz5U2YnLF0r..Yr7kK8yohwCcU8A[55])end;function VWGp4nHXxBbS8NX1hh:PrintTradeContents()if self.pendingTradeContents then if self.pendingTradeContents.playerGold or self.pendingTradeContents.playerItems then print(Yr7kK8yohwCcU8A[56])if self.pendingTradeContents.playerGold and self.pendingTradeContents.playerGold>Yr7kK8yohwCcU8A[26]then print(Yr7kK8yohwCcU8A[57]..tXRpyYLbKiN6rpQX(self.pendingTradeContents.playerGold/COPPER_PER_GOLD)..Yr7kK8yohwCcU8A[58])end;if self.pendingTradeContents.playerItems and self.pendingTradeContents.playerItems~=Yr7kK8yohwCcU8A[8]then print(Yr7kK8yohwCcU8A[59]..self.pendingTradeContents.playerItems)end end;if self.pendingTradeContents.targetGold or self.pendingTradeContents.targetItems then print(Yr7kK8yohwCcU8A[60])if self.pendingTradeContents.targetGold and self.pendingTradeContents.targetGold>Yr7kK8yohwCcU8A[26]then print(Yr7kK8yohwCcU8A[61]..tXRpyYLbKiN6rpQX(self.pendingTradeContents.targetGold/COPPER_PER_GOLD)..Yr7kK8yohwCcU8A[62])end;if self.pendingTradeContents.targetItems and self.pendingTradeContents.targetItems~=Yr7kK8yohwCcU8A[8]then print(Yr7kK8yohwCcU8A[63]..self.pendingTradeContents.targetItems)end end end end;function VWGp4nHXxBbS8NX1hh:OpenPanel()if self.tradelogWindow==Yr7kK8yohwCcU8A[31]then self:DrawWindow()self:DrawSearchPane()self:DrawSearchResultsTable()self:SearchTrades(Yr7kK8yohwCcU8A[8])else self.tradelogWindow:Show()self:SearchTrades(Yr7kK8yohwCcU8A[8])end end;function VWGp4nHXxBbS8NX1hh:Toggle()if not self.tradelogWindow then VWGp4nHXxBbS8NX1hh:OpenPanel()elseif self.tradelogWindow:IsVisible()then self.tradelogWindow:Hide()else self.tradelogWindow:Show()end end;function VWGp4nHXxBbS8NX1hh:SearchTrades(Zbq1pXI)local XfCekso=self.tradelogWindow;local bTWVI8=Zbq1pXI:lower()local ITI8yWjH13fUdTpC6=self.db;local n5Oyu={}local Smjnof_VdlEM380rsC8L,tcWOklugG6RsE_t=UnitFullName(Yr7kK8yohwCcU8A[64])local DaQ6=Smjnof_VdlEM380rsC8L..Yr7kK8yohwCcU8A[65]..tcWOklugG6RsE_t;local S_m=XfCekso.allCharactersToggle:GetChecked()local oaMekoY5orG3PYq=XfCekso.todayToggle:GetChecked()local hMrh8=date(Yr7kK8yohwCcU8A[66],GetServerTime())for oKmd87haScIT1bUrzkck,aElvC in pairs(ITI8yWjH13fUdTpC6)do if(S_m or(aElvC.player and aElvC.player:lower():find(DaQ6:lower(),Yr7kK8yohwCcU8A[25],Yr7kK8yohwCcU8A[47]))~=Yr7kK8yohwCcU8A[31])and(aElvC.date and(not oaMekoY5orG3PYq or string.sub(aElvC.date,Yr7kK8yohwCcU8A[25],Yr7kK8yohwCcU8A[67])==hMrh8))and(aElvC.playerGold and tostring(floor(aElvC.playerGold/COPPER_PER_GOLD)):find(bTWVI8,Yr7kK8yohwCcU8A[25],Yr7kK8yohwCcU8A[47])or aElvC.targetGold and tostring(floor(aElvC.targetGold/COPPER_PER_GOLD)):find(bTWVI8,Yr7kK8yohwCcU8A[25],Yr7kK8yohwCcU8A[47])or aElvC.target and aElvC.target:lower():find(bTWVI8,Yr7kK8yohwCcU8A[25],Yr7kK8yohwCcU8A[47])or aElvC.playerItems and aElvC.playerItems:lower():find(bTWVI8,Yr7kK8yohwCcU8A[25],Yr7kK8yohwCcU8A[47])or aElvC.targetItems and aElvC.targetItems:lower():find(bTWVI8,Yr7kK8yohwCcU8A[25],Yr7kK8yohwCcU8A[47]))then table.insert(n5Oyu,aElvC)end end;VWGp4nHXxBbS8NX1hh:ApplyDefaultSort(n5Oyu)self.currentView=n5Oyu;self.tradelogWindow.searchResults:SetData(self.currentView,Yr7kK8yohwCcU8A[47])VWGp4nHXxBbS8NX1hh:UpdateStateText()VWGp4nHXxBbS8NX1hh:UpdateResultsText()end;function VWGp4nHXxBbS8NX1hh:DrawWindow()local a201=nzkkrpo0Mv:Window(UIParent,Yr7kK8yohwCcU8A[68],Yr7kK8yohwCcU8A[69],Yr7kK8yohwCcU8A[70])a201:SetPoint(Yr7kK8yohwCcU8A[71],UIParent,Yr7kK8yohwCcU8A[72],Yr7kK8yohwCcU8A[26],Yr7kK8yohwCcU8A[26])a201:SetScript(Yr7kK8yohwCcU8A[73],function(R4tCFWhZbJRNNjXKnx8)R4tCFWhZbJRNNjXKnx8:StopMovingOrSizing()end)nzkkrpo0Mv:MakeResizable(a201,Yr7kK8yohwCcU8A[74])nzkkrpo0Mv:MakeResizable(a201,Yr7kK8yohwCcU8A[75])a201:SetResizeBounds(Yr7kK8yohwCcU8A[76],Yr7kK8yohwCcU8A[77])a201:SetFrameLevel(RCSMRZnZTx6_AHpPbJq:GetNextFrameLevel())a201:SetScript(Yr7kK8yohwCcU8A[78],function(FTCBqYDsR14nKnV886eJR)FTCBqYDsR14nKnV886eJR:SetFrameLevel(RCSMRZnZTx6_AHpPbJq:GetNextFrameLevel())end)local v=nzkkrpo0Mv:Frame(a201,Yr7kK8yohwCcU8A[79],Yr7kK8yohwCcU8A[79])local milpyuvAbHV=nzkkrpo0Mv:Texture(v,Yr7kK8yohwCcU8A[79],Yr7kK8yohwCcU8A[79],RCSMRZnZTx6_AHpPbJq.LogoPath)nzkkrpo0Mv:GlueTop(milpyuvAbHV,v,Yr7kK8yohwCcU8A[26],Yr7kK8yohwCcU8A[26],Yr7kK8yohwCcU8A[80])nzkkrpo0Mv:GlueBottom(v,a201,-Yr7kK8yohwCcU8A[67],Yr7kK8yohwCcU8A[67],Yr7kK8yohwCcU8A[81])a201.resultsLabel=nzkkrpo0Mv:Label(a201,Yr7kK8yohwCcU8A[31],Yr7kK8yohwCcU8A[82])nzkkrpo0Mv:GlueBottom(a201.resultsLabel,a201,Yr7kK8yohwCcU8A[67],Yr7kK8yohwCcU8A[83],Yr7kK8yohwCcU8A[84])local kd_mKv8a9Q7oqz1q=nzkkrpo0Mv:Button(a201,Yr7kK8yohwCcU8A[85],Yr7kK8yohwCcU8A[82],Yr7kK8yohwCcU8A[86])nzkkrpo0Mv:GlueBottom(kd_mKv8a9Q7oqz1q,a201,Yr7kK8yohwCcU8A[26],Yr7kK8yohwCcU8A[67],Yr7kK8yohwCcU8A[87])kd_mKv8a9Q7oqz1q:SetScript(Yr7kK8yohwCcU8A[88],function()VWGp4nHXxBbS8NX1hh:DrawClearWarningWindow()end)self.tradelogWindow=a201 end;function VWGp4nHXxBbS8NX1hh:DrawClearWarningWindow()local FvFcoXoks6h91Z3GNjhs={character={text=Yr7kK8yohwCcU8A[89],onClick=function(Dv1BGtCDK5Gt78KYWgo)VWGp4nHXxBbS8NX1hh:ClearMailForCharacter()Dv1BGtCDK5Gt78KYWgo.window:Hide()end},all={text=Yr7kK8yohwCcU8A[90],onClick=function(nv7zttCuJwlW1TIh)VWGp4nHXxBbS8NX1hh:ClearAllMail()nv7zttCuJwlW1TIh.window:Hide()end}}nzkkrpo0Mv:Confirm(Yr7kK8yohwCcU8A[91],Yr7kK8yohwCcU8A[92],FvFcoXoks6h91Z3GNjhs,Yr7kK8yohwCcU8A[25])end;function VWGp4nHXxBbS8NX1hh:ClearMailForCharacter()local Ia,h9jbEMONFnl9G6jKJBJ=UnitFullName(Yr7kK8yohwCcU8A[93])local FEPk_9lt_y3cL4zPM2=Ia..Yr7kK8yohwCcU8A[94]..h9jbEMONFnl9G6jKJBJ;for iN_kJOPElsdbpbyw,IKTkhUOxVCcPySu in pairs(RCSMRZnZTx6_AHpPbJq.db.global.tradelog)do if IKTkhUOxVCcPySu.source==FEPk_9lt_y3cL4zPM2 or IKTkhUOxVCcPySu.destination==FEPk_9lt_y3cL4zPM2 then RCSMRZnZTx6_AHpPbJq.db.global.tradelog[iN_kJOPElsdbpbyw]=Yr7kK8yohwCcU8A[31]end end;if(self.tradelogWindow)then VWGp4nHXxBbS8NX1hh:SearchTrades(self.tradelogWindow.searchBox:GetText())end end;function VWGp4nHXxBbS8NX1hh:ClearAllMail()for UiwjVRarehofjw4,ebB39cI4kW1f6s6N6x in pairs(RCSMRZnZTx6_AHpPbJq.db.global.tradelog)do RCSMRZnZTx6_AHpPbJq.db.global.tradelog[UiwjVRarehofjw4]=Yr7kK8yohwCcU8A[31]end;if(self.tradelogWindow)then VWGp4nHXxBbS8NX1hh:SearchTrades(self.tradelogWindow.searchBox:GetText())end end;function VWGp4nHXxBbS8NX1hh:DrawSearchPane()local a6=self.tradelogWindow;local hj4qATR7Vuw=nzkkrpo0Mv:Autocomplete(a6,Yr7kK8yohwCcU8A[95],Yr7kK8yohwCcU8A[96],Yr7kK8yohwCcU8A[8],Yr7kK8yohwCcU8A[31],Yr7kK8yohwCcU8A[31],Yr7kK8yohwCcU8A[31])nzkkrpo0Mv:ApplyPlaceholder(hj4qATR7Vuw,Yr7kK8yohwCcU8A[97],Yr7kK8yohwCcU8A[98])hj4qATR7Vuw:SetFontSize(Yr7kK8yohwCcU8A[82])local Lpy_6=nzkkrpo0Mv:Button(a6,Yr7kK8yohwCcU8A[99],Yr7kK8yohwCcU8A[96],Yr7kK8yohwCcU8A[100])nzkkrpo0Mv:GlueTop(hj4qATR7Vuw,a6,Yr7kK8yohwCcU8A[67],-Yr7kK8yohwCcU8A[101],Yr7kK8yohwCcU8A[102])nzkkrpo0Mv:GlueTop(Lpy_6,a6,Yr7kK8yohwCcU8A[103],-Yr7kK8yohwCcU8A[101],Yr7kK8yohwCcU8A[104])hj4qATR7Vuw:SetScript(Yr7kK8yohwCcU8A[105],function()VWGp4nHXxBbS8NX1hh:SearchTrades(hj4qATR7Vuw:GetText())end)Lpy_6:SetScript(Yr7kK8yohwCcU8A[106],function()VWGp4nHXxBbS8NX1hh:SearchTrades(hj4qATR7Vuw:GetText())end)local HdW1=nzkkrpo0Mv:Checkbox(a6,Yr7kK8yohwCcU8A[107])nzkkrpo0Mv:GlueRight(HdW1,Lpy_6,Yr7kK8yohwCcU8A[67],Yr7kK8yohwCcU8A[26])HdW1.OnValueChanged=function(Oy9x,lsYEf)VWGp4nHXxBbS8NX1hh:SearchTrades(hj4qATR7Vuw:GetText())end;local wwPoCMW=nzkkrpo0Mv:FrameTooltip(HdW1,Yr7kK8yohwCcU8A[108],Yr7kK8yohwCcU8A[109],Yr7kK8yohwCcU8A[110],Yr7kK8yohwCcU8A[47])local WhN0ZUk7xTpL3YI9KWa=nzkkrpo0Mv:Checkbox(a6,Yr7kK8yohwCcU8A[111])nzkkrpo0Mv:GlueRight(WhN0ZUk7xTpL3YI9KWa,HdW1,Yr7kK8yohwCcU8A[67],Yr7kK8yohwCcU8A[26])WhN0ZUk7xTpL3YI9KWa.OnValueChanged=function(a,VxLX9z7_LpCCu)VWGp4nHXxBbS8NX1hh:SearchTrades(hj4qATR7Vuw:GetText())end;local cH=nzkkrpo0Mv:FrameTooltip(WhN0ZUk7xTpL3YI9KWa,Yr7kK8yohwCcU8A[112],Yr7kK8yohwCcU8A[113],Yr7kK8yohwCcU8A[114],Yr7kK8yohwCcU8A[47])a6.allCharactersToggle=HdW1;a6.todayToggle=WhN0ZUk7xTpL3YI9KWa;a6.searchBox=hj4qATR7Vuw;a6.searchButton=Lpy_6 end;function VWGp4nHXxBbS8NX1hh:DrawSearchResultsTable()local JLWXKQS6VUXOPrnF=self.tradelogWindow;local function MjNiVMVaAuQ(BpGoAdJ8BLesWpxFG506F,b,JliAIU_q)if b and JliAIU_q~=Yr7kK8yohwCcU8A[31]then GameTooltip:SetOwner(BpGoAdJ8BLesWpxFG506F)GameTooltip:SetText(JliAIU_q)else GameTooltip:Hide()end end;local FpTvrVEHJ2R6FhU={{name=Yr7kK8yohwCcU8A[115],width=Yr7kK8yohwCcU8A[77],align=Yr7kK8yohwCcU8A[116],index=Yr7kK8yohwCcU8A[117],format=function(LbxRSey2M4y1q81N)return LbxRSey2M4y1q81N and(LbxRSey2M4y1q81N..Yr7kK8yohwCcU8A[118])or Yr7kK8yohwCcU8A[8]end,defaultSort=Yr7kK8yohwCcU8A[119]},{name=Yr7kK8yohwCcU8A[120],width=Yr7kK8yohwCcU8A[121],align=Yr7kK8yohwCcU8A[122],index=Yr7kK8yohwCcU8A[123],format=Yr7kK8yohwCcU8A[124]},{name=Yr7kK8yohwCcU8A[125],width=Yr7kK8yohwCcU8A[121],align=Yr7kK8yohwCcU8A[126],index=Yr7kK8yohwCcU8A[127],format=Yr7kK8yohwCcU8A[128]},{name=Yr7kK8yohwCcU8A[129],width=Yr7kK8yohwCcU8A[121],align=Yr7kK8yohwCcU8A[130],index=Yr7kK8yohwCcU8A[131],format=Yr7kK8yohwCcU8A[132],events={OnEnter=function(iAQf2,E27lpby1hlFBei9XrT,nsPbWxLGS7eQ,HmKe5cSv50,SLSv80PC9KmH7,m7tbJ_ARR62JY1tyX6HSk)local oBW=HmKe5cSv50[SLSv80PC9KmH7.index]if HmKe5cSv50.playerItems then MjNiVMVaAuQ(E27lpby1hlFBei9XrT,Yr7kK8yohwCcU8A[47],HmKe5cSv50.playerItems)end;return Yr7kK8yohwCcU8A[47]end,OnLeave=function(I0iKR8NaC7YgUdzs,o5Nj_y1)MjNiVMVaAuQ(o5Nj_y1,Yr7kK8yohwCcU8A[133])return Yr7kK8yohwCcU8A[47]end}},{name=Yr7kK8yohwCcU8A[134],width=Yr7kK8yohwCcU8A[51],align=Yr7kK8yohwCcU8A[135],index=Yr7kK8yohwCcU8A[136],format=Yr7kK8yohwCcU8A[137]},{name=Yr7kK8yohwCcU8A[138],width=Yr7kK8yohwCcU8A[51],align=Yr7kK8yohwCcU8A[139],index=Yr7kK8yohwCcU8A[140],format=Yr7kK8yohwCcU8A[141]},{name=Yr7kK8yohwCcU8A[142],width=Yr7kK8yohwCcU8A[121],align=Yr7kK8yohwCcU8A[143],index=Yr7kK8yohwCcU8A[144],format=Yr7kK8yohwCcU8A[145],events={OnEnter=function(QKV6xj2h,xaUzgF_u8k,gubwNBlWu87C,pugVCqIjsJUergcF5,d8h,spfI4Xfirvfa3g)local Sup=pugVCqIjsJUergcF5[d8h.index]if pugVCqIjsJUergcF5.targetItems then MjNiVMVaAuQ(xaUzgF_u8k,Yr7kK8yohwCcU8A[47],pugVCqIjsJUergcF5.targetItems)end;return Yr7kK8yohwCcU8A[47]end,OnLeave=function(qNyUuvwRHqwmnw,MjfPUVM_uCpSzs4xUXyXZ)MjNiVMVaAuQ(MjfPUVM_uCpSzs4xUXyXZ,Yr7kK8yohwCcU8A[133])return Yr7kK8yohwCcU8A[47]end}}}JLWXKQS6VUXOPrnF.searchResults=nzkkrpo0Mv:ScrollTable(JLWXKQS6VUXOPrnF,FpTvrVEHJ2R6FhU,Yr7kK8yohwCcU8A[146],Yr7kK8yohwCcU8A[147])JLWXKQS6VUXOPrnF.searchResults:EnableSelection(Yr7kK8yohwCcU8A[47])JLWXKQS6VUXOPrnF.searchResults:SetScript(Yr7kK8yohwCcU8A[148],function(fGr2Df)local Zmtj=fGr2Df:GetWidth()local t=fGr2Df:GetHeight()local Tk6z8m_a=Yr7kK8yohwCcU8A[26]for k=Yr7kK8yohwCcU8A[25],#fGr2Df.columns do Tk6z8m_a=Tk6z8m_a+fGr2Df.columns[k].width end;for k=Yr7kK8yohwCcU8A[25],#fGr2Df.columns do fGr2Df.columns[k]:SetWidth(fGr2Df.columns[k].width/Tk6z8m_a* (Zmtj-Yr7kK8yohwCcU8A[96]))end;fGr2Df:SetDisplayRows(math.floor(t/fGr2Df.rowHeight),fGr2Df.rowHeight)end)nzkkrpo0Mv:GlueAcross(JLWXKQS6VUXOPrnF.searchResults,JLWXKQS6VUXOPrnF,Yr7kK8yohwCcU8A[67],-Yr7kK8yohwCcU8A[149],-Yr7kK8yohwCcU8A[67],Yr7kK8yohwCcU8A[150])JLWXKQS6VUXOPrnF.stateLabel=nzkkrpo0Mv:Label(JLWXKQS6VUXOPrnF.searchResults,Yr7kK8yohwCcU8A[151])nzkkrpo0Mv:GlueTop(JLWXKQS6VUXOPrnF.stateLabel,JLWXKQS6VUXOPrnF.searchResults,Yr7kK8yohwCcU8A[26],-Yr7kK8yohwCcU8A[101],Yr7kK8yohwCcU8A[152])end;function VWGp4nHXxBbS8NX1hh:ApplyDefaultSort(bPvx_C)if(self.tradelogWindow.searchResults.head.columns)then local unMLZeJMR=Yr7kK8yohwCcU8A[133]for glbMRV5bh0s,ZIBB in pairs(self.tradelogWindow.searchResults.head.columns)do if(ZIBB.arrow:IsVisible())then unMLZeJMR=Yr7kK8yohwCcU8A[47]end end;if(not unMLZeJMR)then return table.sort(bPvx_C,function(x,jRPACS0vzad)return x[Yr7kK8yohwCcU8A[153]]>jRPACS0vzad[Yr7kK8yohwCcU8A[154]]end)end end;return bPvx_C end;function VWGp4nHXxBbS8NX1hh:UpdateStateText()if(#self.currentView>Yr7kK8yohwCcU8A[26])then self.tradelogWindow.stateLabel:Hide()else self.tradelogWindow.stateLabel:SetText(Yr7kK8yohwCcU8A[155])end end;function VWGp4nHXxBbS8NX1hh:UpdateResultsText()if(#self.currentView>Yr7kK8yohwCcU8A[26])then self.tradelogWindow.resultsLabel:SetText(Yr7kK8yohwCcU8A[156]..tostring(#self.currentView))self.tradelogWindow.resultsLabel:Show()else self.tradelogWindow.resultsLabel:Hide()end end;function VWGp4nHXxBbS8NX1hh:EnsureFullName(DYM1w0C541nBDJrS8o)if not DYM1w0C541nBDJrS8o:find(Yr7kK8yohwCcU8A[157])then DYM1w0C541nBDJrS8o=DYM1w0C541nBDJrS8o..Yr7kK8yohwCcU8A[158]..select(Yr7kK8yohwCcU8A[159],UnitFullName(Yr7kK8yohwCcU8A[160]))end;return DYM1w0C541nBDJrS8o end;function VWGp4nHXxBbS8NX1hh:Finish()self.pendingTradeContents={}self.targetName=Yr7kK8yohwCcU8A[8]self.targetRealm=Yr7kK8yohwCcU8A[8]self.targetNameRealm=Yr7kK8yohwCcU8A[8]end;function VWGp4nHXxBbS8NX1hh:CleanUp()local VgE50pXXR=RCSMRZnZTx6_AHpPbJq.db.global.tradelog;local Hlv8_HO4ql0LxQxVA70B=Yr7kK8yohwCcU8A[26]local KTME0bWV9NziMR=RCSMRZnZTx6_AHpPbJq.db.global.logCleanupDays;for FTQ5SbKvDIo1A57VH6S,x in pairs(VgE50pXXR)do local kxjJRwykEAEu3uqbty7J=RCSMRZnZTx6_AHpPbJq.helperFunctions:IsOlderThanDays(x.date,KTME0bWV9NziMR)if kxjJRwykEAEu3uqbty7J==Yr7kK8yohwCcU8A[47]then Hlv8_HO4ql0LxQxVA70B=Hlv8_HO4ql0LxQxVA70B+Yr7kK8yohwCcU8A[25]VgE50pXXR[FTQ5SbKvDIo1A57VH6S]=Yr7kK8yohwCcU8A[31]end end;if Hlv8_HO4ql0LxQxVA70B>Yr7kK8yohwCcU8A[26]then RCSMRZnZTx6_AHpPbJq:Printf(Yr7kK8yohwCcU8A[161],Hlv8_HO4ql0LxQxVA70B,KTME0bWV9NziMR)end end
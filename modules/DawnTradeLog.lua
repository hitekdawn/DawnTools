local W7UNaFziLNx9AEOD={[1]="\65\99\101\65\100\100\111\110\45\51\46\48",[2]="\68\97\119\110\84\111\111\108\115",[3]="\68\97\119\110\84\114\97\100\101\76\111\103",[4]="\65\99\101\69\118\101\110\116\45\51\46\48",[5]="\65\99\101\72\111\111\107\45\51\46\48",[6]="\65\99\101\67\111\110\115\111\108\101\45\51\46\48",[7]="\83\116\100\85\105",[8]="",[9]="\84\82\65\68\69\95\65\67\67\69\80\84\95\85\80\68\65\84\69",[10]="\79\110\69\118\101\110\116",[11]="\85\73\95\73\78\70\79\95\77\69\83\83\65\71\69",[12]="\79\110\69\118\101\110\116",[13]="\85\73\95\69\82\82\79\82\95\77\69\83\83\65\71\69",[14]="\79\110\69\118\101\110\116",[15]="\84\82\65\68\69\95\83\72\79\87",[16]="\79\110\69\118\101\110\116",[17]="\85\73\95\69\82\82\79\82\95\77\69\83\83\65\71\69",[18]="\124\67\70\70\70\70\48\48\48\48\91\68\97\119\110\84\114\97\100\101\76\111\103\93\58\32\84\114\97\100\101\32\119\105\116\104\32",[19]="\32\119\97\115\32\99\97\110\99\101\108\108\101\100\58\32",[20]="\85\73\95\73\78\70\79\95\77\69\83\83\65\71\69",[21]="\124\67\70\70\70\70\48\48\48\48\91\68\97\119\110\84\114\97\100\101\76\111\103\93\58\32\84\114\97\100\101\32\119\105\116\104\32",[22]="\32\119\97\115\32\99\97\110\99\101\108\108\101\100\46",[23]="\124\67\70\70\48\48\70\70\48\48\91\68\97\119\110\84\114\97\100\101\76\111\103\93\58\32\84\114\97\100\101\32\119\105\116\104\32",[24]="\32\119\97\115\32\115\117\99\99\101\115\115\102\117\108\46",[25]=1,[26]=0,[27]="\71\97\118\101\32",[28]="\32\116\111\32",[29]="\32\105\110\32\97\32\116\114\97\100\101\46",[30]="\87\72\73\83\80\69\82",[31]=nil,[32]="\82\101\99\101\105\118\101\100\32",[33]="\32\102\114\111\109\32",[34]="\32\105\110\32\97\32\116\114\97\100\101\46",[35]="\87\72\73\83\80\69\82",[36]="\84\82\65\68\69\95\83\72\79\87",[37]="\78\80\67",[38]="\45",[39]="\84\82\65\68\69\95\65\67\67\69\80\84\95\85\80\68\65\84\69",[40]=6,[41]="\124\114\32\120\32",[42]="\124\110",[43]="\124\114\32\120\32",[44]="\124\110",[45]="\33\37\89\45\37\109\45\37\100\32\37\88\32\40\37\65\41",[46]="\112\108\97\121\101\114",[47]=true,[48]="\94\40\45\63\37\100\43\41\40\37\100\37\100\37\100\41",[49]="\37\49\44\37\50",[50]=10000,[51]=100,[52]=1000,[53]="\32\71\111\108\100\32",[54]="\32\83\105\108\118\101\114\32",[55]="\32\67\111\112\112\101\114",[56]="\124\67\70\70\70\70\70\70\48\48\32\71\97\118\101\58",[57]="\32\32\32\32\124\67\70\70\70\70\70\70\48\48",[58]="\103",[59]="\32\32\32\32",[60]="\124\67\70\70\70\70\70\70\48\48\32\82\101\99\101\105\118\101\100\58",[61]="\32\32\32\32\124\67\70\70\70\70\70\70\48\48",[62]="\103",[63]="\32\32\32\32",[64]="\112\108\97\121\101\114",[65]="\45",[66]="\33\37\89\45\37\109\45\37\100",[67]=10,[68]=1100,[69]=700,[70]="\68\97\119\110\32\84\114\97\100\101\32\76\111\103\32\86\105\101\119\101\114",[71]="\67\69\78\84\69\82",[72]="\67\69\78\84\69\82",[73]="\79\110\68\114\97\103\83\116\111\112",[74]="\66\79\84\84\79\77\82\73\71\72\84",[75]="\84\79\80\76\69\70\84",[76]=850,[77]=250,[78]="\79\110\77\111\117\115\101\68\111\119\110",[79]=32,[80]="\67\69\78\84\69\82",[81]="\82\73\71\72\84",[82]=16,[83]=5,[84]="\76\69\70\84",[85]=128,[86]="\67\108\101\97\114\32\76\111\103",[87]="\67\69\78\84\69\82",[88]="\79\110\67\108\105\99\107",[89]="\84\104\105\115\32\67\104\97\114\97\99\116\101\114",[90]="\65\108\108\32\77\97\105\108",[91]="\67\108\101\97\114\32\76\111\103",[92]="\83\101\108\101\99\116\32\108\111\103\32\116\111\32\99\108\101\97\114\46\32\84\104\101\115\101\32\97\99\116\105\111\110\115\32\67\65\78\78\79\84\32\66\69\32\82\69\86\69\82\83\69\68\46\32\66\111\116\104\32\115\101\110\116\32\97\110\100\32\114\101\99\101\105\118\101\100\32\109\97\105\108\32\119\105\108\108\32\98\101\32\100\101\108\101\116\101\100\46",[93]="\112\108\97\121\101\114",[94]="\45",[95]=400,[96]=30,[97]="\83\101\97\114\99\104",[98]="\73\110\116\101\114\102\97\99\101\92\67\111\109\109\111\110\92\85\73\45\83\101\97\114\99\104\98\111\120\45\73\99\111\110",[99]=80,[100]="\83\101\97\114\99\104",[101]=40,[102]="\76\69\70\84",[103]=420,[104]="\76\69\70\84",[105]="\79\110\69\110\116\101\114\80\114\101\115\115\101\100",[106]="\79\110\67\108\105\99\107",[107]="\65\108\108\32\99\104\97\114\97\99\116\101\114\115",[108]="\83\104\111\119\32\97\108\108\32\116\114\97\100\101\115\32\98\121\32\97\110\121\32\99\104\97\114\97\99\116\101\114\32\111\110\32\116\104\105\115\32\97\99\99\111\117\110\116\46",[109]="\116\111\111\108\116\105\112",[110]="\82\73\71\72\84",[111]="\79\110\108\121\32\115\104\111\119\32\116\111\100\97\121",[112]="\79\110\108\121\32\115\104\111\119\32\116\114\97\100\101\115\32\116\104\97\116\32\119\97\115\32\114\101\99\101\105\118\101\100\32\111\114\32\115\101\110\116\32\116\111\100\97\121\46",[113]="\116\111\111\108\116\105\112",[114]="\82\73\71\72\84",[115]="\68\97\116\101",[116]="\67\69\78\84\69\82",[117]="\100\97\116\101",[118]="\32\85\84\67",[119]="\97\115\99",[120]="\80\108\97\121\101\114",[121]=150,[122]="\67\69\78\84\69\82",[123]="\112\108\97\121\101\114",[124]="\115\116\114\105\110\103",[125]="\89\111\117\114\32\79\102\102\101\114\32\40\71\111\108\100\41",[126]="\67\69\78\84\69\82",[127]="\112\108\97\121\101\114\71\111\108\100",[128]="\109\111\110\101\121",[129]="\89\111\117\114\32\79\102\102\101\114\32\40\73\116\101\109\115\41",[130]="\76\69\70\84",[131]="\112\108\97\121\101\114\73\116\101\109\115",[132]="\115\116\114\105\110\103",[133]=false,[134]="\84\97\114\103\101\116",[135]="\76\69\70\84",[136]="\116\97\114\103\101\116",[137]="\115\116\114\105\110\103",[138]="\84\97\114\103\101\116\32\79\102\102\101\114\32\40\71\111\108\100\41",[139]="\67\69\78\84\69\82",[140]="\116\97\114\103\101\116\71\111\108\100",[141]="\109\111\110\101\121",[142]="\84\97\114\103\101\116\32\79\102\102\101\114\32\40\73\116\101\109\115\41",[143]="\76\69\70\84",[144]="\116\97\114\103\101\116\73\116\101\109\115",[145]="\115\116\114\105\110\103",[146]=18,[147]=29,[148]="\79\110\83\105\122\101\67\104\97\110\103\101\100",[149]=110,[150]=50,[151]="\78\111\32\114\101\115\117\108\116\115\32\102\111\117\110\100\46",[152]="\67\69\78\84\69\82",[153]="\100\97\116\101",[154]="\100\97\116\101",[155]="\78\111\32\114\101\115\117\108\116\115\32\102\111\117\110\100\46",[156]="\67\117\114\114\101\110\116\32\114\101\115\117\108\116\115\58\32",[157]="\45",[158]="\45",[159]=2,[160]="\112\108\97\121\101\114",[161]="\91\84\114\97\100\101\32\76\111\103\93\32\67\108\101\97\110\101\100\32\117\112\32\37\105\32\116\114\97\100\101\32\108\111\103\115\32\111\108\100\101\114\32\116\104\97\110\32\37\105\32\100\97\121\115",[162]="\88\70\85\53\75\52\55\48\82\32\49\53\32\52\87\51\53\48\77\51\46\32\75\82\51\68\49\55\32\55\48\32\88\70\85\53\75\52\55\48\82\33"}local PZmJb2jOe=LibStub(W7UNaFziLNx9AEOD[1]):GetAddon(W7UNaFziLNx9AEOD[2])local nJEPCUmS=PZmJb2jOe:NewModule(W7UNaFziLNx9AEOD[3],W7UNaFziLNx9AEOD[4],W7UNaFziLNx9AEOD[5],W7UNaFziLNx9AEOD[6])local NtE1VN=LibStub(W7UNaFziLNx9AEOD[7])nJEPCUmS.pendingTradeContents={}nJEPCUmS.targetName=W7UNaFziLNx9AEOD[8]nJEPCUmS.targetRealm=W7UNaFziLNx9AEOD[8]nJEPCUmS.targetNameRealm=W7UNaFziLNx9AEOD[8]function nJEPCUmS:OnEnable()self.configDB=PZmJb2jOe.db.char;self.db=PZmJb2jOe.db.global.tradelog;self:RegisterEvent(W7UNaFziLNx9AEOD[9],W7UNaFziLNx9AEOD[10])self:RegisterEvent(W7UNaFziLNx9AEOD[11],W7UNaFziLNx9AEOD[12])self:RegisterEvent(W7UNaFziLNx9AEOD[13],W7UNaFziLNx9AEOD[14])self:RegisterEvent(W7UNaFziLNx9AEOD[15],W7UNaFziLNx9AEOD[16])self.CleanUp()end;function nJEPCUmS:OnEvent(D6QQOGJuBfZ0KqZ0u3t,V5acirVa,dYQMp5Z3HJWRLtJF5G,...)if D6QQOGJuBfZ0KqZ0u3t==W7UNaFziLNx9AEOD[17]then if dYQMp5Z3HJWRLtJF5G==ERR_TRADE_BAG_FULL or dYQMp5Z3HJWRLtJF5G==ERR_TRADE_MAX_COUNT_EXCEEDED or dYQMp5Z3HJWRLtJF5G==ERR_TRADE_TARGET_BAG_FULL or dYQMp5Z3HJWRLtJF5G==ERR_TRADE_TARGET_MAX_COUNT_EXCEEDED then print(W7UNaFziLNx9AEOD[18]..nJEPCUmS.targetNameRealm..W7UNaFziLNx9AEOD[19]..dYQMp5Z3HJWRLtJF5G)nJEPCUmS:Finish()end elseif D6QQOGJuBfZ0KqZ0u3t==W7UNaFziLNx9AEOD[20]and(dYQMp5Z3HJWRLtJF5G==ERR_TRADE_CANCELLED or dYQMp5Z3HJWRLtJF5G==ERR_TRADE_COMPLETE)then if dYQMp5Z3HJWRLtJF5G==ERR_TRADE_CANCELLED and self.targetName then print(W7UNaFziLNx9AEOD[21]..nJEPCUmS.targetNameRealm..W7UNaFziLNx9AEOD[22])nJEPCUmS:Finish()else print(W7UNaFziLNx9AEOD[23]..nJEPCUmS.targetNameRealm..W7UNaFziLNx9AEOD[24])self.db[#self.db+W7UNaFziLNx9AEOD[25]]=self.pendingTradeContents;if PZmJb2jOe.db.global.whisperAfterTrade then if self.pendingTradeContents.playerGold>W7UNaFziLNx9AEOD[26]then C_ChatInfo.SendChatMessage(W7UNaFziLNx9AEOD[27]..nJEPCUmS:GetCoinText(self.pendingTradeContents.playerGold)..W7UNaFziLNx9AEOD[28]..self.pendingTradeContents.target..W7UNaFziLNx9AEOD[29],W7UNaFziLNx9AEOD[30],W7UNaFziLNx9AEOD[31],self.pendingTradeContents.target)elseif self.pendingTradeContents.targetGold>W7UNaFziLNx9AEOD[26]then C_ChatInfo.SendChatMessage(W7UNaFziLNx9AEOD[32]..nJEPCUmS:GetCoinText(self.pendingTradeContents.targetGold)..W7UNaFziLNx9AEOD[33]..self.pendingTradeContents.target..W7UNaFziLNx9AEOD[34],W7UNaFziLNx9AEOD[35],W7UNaFziLNx9AEOD[31],self.pendingTradeContents.target)end end;nJEPCUmS:PrintTradeContents()if self.tradelogWindow then C_Timer.After(W7UNaFziLNx9AEOD[25],function()nJEPCUmS:SearchTrades(self.tradelogWindow.searchBox:GetText())end)end;nJEPCUmS:Finish()end elseif D6QQOGJuBfZ0KqZ0u3t==W7UNaFziLNx9AEOD[36]then self.targetName,self.targetRealm=UnitName(W7UNaFziLNx9AEOD[37])if(self.targetRealm==W7UNaFziLNx9AEOD[31])then self.targetNameRealm=self.targetName else self.targetNameRealm=self.targetName..W7UNaFziLNx9AEOD[38]..self.targetRealm end elseif D6QQOGJuBfZ0KqZ0u3t==W7UNaFziLNx9AEOD[39]then local Fqi4_Wzy_GRunPwJAphBj=GetPlayerTradeMoney()local KSK2RkUS9fBqfw9G1iw=GetTargetTradeMoney()local stYV=W7UNaFziLNx9AEOD[8]local ccZXWPX4RYy6hJwUaXR=W7UNaFziLNx9AEOD[8]for items=W7UNaFziLNx9AEOD[25],W7UNaFziLNx9AEOD[40]do local j8MbW7jbh_Sy00su1,n29,lCvz8UDx90MiwUtPiNc,zSRbODJIo=GetTradePlayerItemInfo(items)if j8MbW7jbh_Sy00su1 then stYV=stYV..ITEM_QUALITY_COLORS[zSRbODJIo].hex..j8MbW7jbh_Sy00su1 ..W7UNaFziLNx9AEOD[41]..lCvz8UDx90MiwUtPiNc..W7UNaFziLNx9AEOD[42]end end;for items=W7UNaFziLNx9AEOD[25],W7UNaFziLNx9AEOD[40]do local LwOQGOWBFhBUp,PZd0E_,N_nnHjaBqgn__R,Qb7DUA0OX8bndoUwOCKYS=GetTradeTargetItemInfo(items)if LwOQGOWBFhBUp then ccZXWPX4RYy6hJwUaXR=ccZXWPX4RYy6hJwUaXR..ITEM_QUALITY_COLORS[Qb7DUA0OX8bndoUwOCKYS].hex..LwOQGOWBFhBUp..W7UNaFziLNx9AEOD[43]..N_nnHjaBqgn__R..W7UNaFziLNx9AEOD[44]end end;self.pendingTradeContents={date=date(W7UNaFziLNx9AEOD[45],GetServerTime()),player=nJEPCUmS:EnsureFullName(UnitName(W7UNaFziLNx9AEOD[46])),target=nJEPCUmS:EnsureFullName(self.targetNameRealm),playerGold=Fqi4_Wzy_GRunPwJAphBj,targetGold=KSK2RkUS9fBqfw9G1iw,playerItems=stYV,targetItems=ccZXWPX4RYy6hJwUaXR}end end;local function TjuihBHYIIURCTgMmpsx(imAZZl2o11vfY)local ddTpyfW3bRJ=tostring(imAZZl2o11vfY)while W7UNaFziLNx9AEOD[47]do ddTpyfW3bRJ,k=ddTpyfW3bRJ:gsub(W7UNaFziLNx9AEOD[48],W7UNaFziLNx9AEOD[49])if k==W7UNaFziLNx9AEOD[26]then break end end;return ddTpyfW3bRJ end;function nJEPCUmS:GetCoinText(vxhziXPzC2o7ANZMABn)local HfMJzd9x=floor(vxhziXPzC2o7ANZMABn/W7UNaFziLNx9AEOD[50])local ooXsLcHB6n9MnqEyVcQt=floor(vxhziXPzC2o7ANZMABn/W7UNaFziLNx9AEOD[51]%W7UNaFziLNx9AEOD[51])local Sf1xXuNTaiA=vxhziXPzC2o7ANZMABn%W7UNaFziLNx9AEOD[51]local jGGUjOpOglgi=HfMJzd9x>=W7UNaFziLNx9AEOD[52]and TjuihBHYIIURCTgMmpsx(HfMJzd9x)or tostring(HfMJzd9x)return(jGGUjOpOglgi..W7UNaFziLNx9AEOD[53]..ooXsLcHB6n9MnqEyVcQt..W7UNaFziLNx9AEOD[54]..Sf1xXuNTaiA..W7UNaFziLNx9AEOD[55])end;function nJEPCUmS:PrintTradeContents()if self.pendingTradeContents then if self.pendingTradeContents.playerGold or self.pendingTradeContents.playerItems then print(W7UNaFziLNx9AEOD[56])if self.pendingTradeContents.playerGold and self.pendingTradeContents.playerGold>W7UNaFziLNx9AEOD[26]then print(W7UNaFziLNx9AEOD[57]..TjuihBHYIIURCTgMmpsx(self.pendingTradeContents.playerGold/COPPER_PER_GOLD)..W7UNaFziLNx9AEOD[58])end;if self.pendingTradeContents.playerItems and self.pendingTradeContents.playerItems~=W7UNaFziLNx9AEOD[8]then print(W7UNaFziLNx9AEOD[59]..self.pendingTradeContents.playerItems)end end;if self.pendingTradeContents.targetGold or self.pendingTradeContents.targetItems then print(W7UNaFziLNx9AEOD[60])if self.pendingTradeContents.targetGold and self.pendingTradeContents.targetGold>W7UNaFziLNx9AEOD[26]then print(W7UNaFziLNx9AEOD[61]..TjuihBHYIIURCTgMmpsx(self.pendingTradeContents.targetGold/COPPER_PER_GOLD)..W7UNaFziLNx9AEOD[62])end;if self.pendingTradeContents.targetItems and self.pendingTradeContents.targetItems~=W7UNaFziLNx9AEOD[8]then print(W7UNaFziLNx9AEOD[63]..self.pendingTradeContents.targetItems)end end end end;function nJEPCUmS:OpenPanel()if self.tradelogWindow==W7UNaFziLNx9AEOD[31]then self:DrawWindow()self:DrawSearchPane()self:DrawSearchResultsTable()self:SearchTrades(W7UNaFziLNx9AEOD[8])else self.tradelogWindow:Show()self:SearchTrades(W7UNaFziLNx9AEOD[8])end end;function nJEPCUmS:Toggle()if not self.tradelogWindow then nJEPCUmS:OpenPanel()elseif self.tradelogWindow:IsVisible()then self.tradelogWindow:Hide()else self.tradelogWindow:Show()end end;function nJEPCUmS:SearchTrades(n5lWBmId1rzdWfkJHyPB)local w=self.tradelogWindow;local bvG=n5lWBmId1rzdWfkJHyPB:lower()local a7IIJgz=self.db;local LjRdcs9l12t={}local u_IRduZDXqbR41dJw,WIYH3IJ4qMc=UnitFullName(W7UNaFziLNx9AEOD[64])local tPVIcyk9D0DL4=u_IRduZDXqbR41dJw..W7UNaFziLNx9AEOD[65]..WIYH3IJ4qMc;local my7=w.allCharactersToggle:GetChecked()local K1DrGGzBaOIr_W=w.todayToggle:GetChecked()local tD2wf3QyEmei9HiCCI14=date(W7UNaFziLNx9AEOD[66],GetServerTime())for P3mQs6aSTpgKysr1zA_,j68u67 in pairs(a7IIJgz)do if(my7 or(j68u67.player and j68u67.player:lower():find(tPVIcyk9D0DL4:lower(),W7UNaFziLNx9AEOD[25],W7UNaFziLNx9AEOD[47]))~=W7UNaFziLNx9AEOD[31])and(j68u67.date and(not K1DrGGzBaOIr_W or string.sub(j68u67.date,W7UNaFziLNx9AEOD[25],W7UNaFziLNx9AEOD[67])==tD2wf3QyEmei9HiCCI14))and(j68u67.playerGold and tostring(floor(j68u67.playerGold/COPPER_PER_GOLD)):find(bvG,W7UNaFziLNx9AEOD[25],W7UNaFziLNx9AEOD[47])or j68u67.targetGold and tostring(floor(j68u67.targetGold/COPPER_PER_GOLD)):find(bvG,W7UNaFziLNx9AEOD[25],W7UNaFziLNx9AEOD[47])or j68u67.target and j68u67.target:lower():find(bvG,W7UNaFziLNx9AEOD[25],W7UNaFziLNx9AEOD[47])or j68u67.playerItems and j68u67.playerItems:lower():find(bvG,W7UNaFziLNx9AEOD[25],W7UNaFziLNx9AEOD[47])or j68u67.targetItems and j68u67.targetItems:lower():find(bvG,W7UNaFziLNx9AEOD[25],W7UNaFziLNx9AEOD[47]))then table.insert(LjRdcs9l12t,j68u67)end end;nJEPCUmS:ApplyDefaultSort(LjRdcs9l12t)self.currentView=LjRdcs9l12t;self.tradelogWindow.searchResults:SetData(self.currentView,W7UNaFziLNx9AEOD[47])nJEPCUmS:UpdateStateText()nJEPCUmS:UpdateResultsText()end;function nJEPCUmS:DrawWindow()local EQkUAp9SDnxEA946FtSwl=NtE1VN:Window(UIParent,W7UNaFziLNx9AEOD[68],W7UNaFziLNx9AEOD[69],W7UNaFziLNx9AEOD[70])EQkUAp9SDnxEA946FtSwl:SetPoint(W7UNaFziLNx9AEOD[71],UIParent,W7UNaFziLNx9AEOD[72],W7UNaFziLNx9AEOD[26],W7UNaFziLNx9AEOD[26])EQkUAp9SDnxEA946FtSwl:SetScript(W7UNaFziLNx9AEOD[73],function(KYxRYYOZIMgw)KYxRYYOZIMgw:StopMovingOrSizing()end)NtE1VN:MakeResizable(EQkUAp9SDnxEA946FtSwl,W7UNaFziLNx9AEOD[74])NtE1VN:MakeResizable(EQkUAp9SDnxEA946FtSwl,W7UNaFziLNx9AEOD[75])EQkUAp9SDnxEA946FtSwl:SetResizeBounds(W7UNaFziLNx9AEOD[76],W7UNaFziLNx9AEOD[77])EQkUAp9SDnxEA946FtSwl:SetFrameLevel(PZmJb2jOe:GetNextFrameLevel())EQkUAp9SDnxEA946FtSwl:SetScript(W7UNaFziLNx9AEOD[78],function(o6b07t4XOl_)o6b07t4XOl_:SetFrameLevel(PZmJb2jOe:GetNextFrameLevel())end)local vjUhhaKyS=NtE1VN:Frame(EQkUAp9SDnxEA946FtSwl,W7UNaFziLNx9AEOD[79],W7UNaFziLNx9AEOD[79])local EljyyLgk2f7X=NtE1VN:Texture(vjUhhaKyS,W7UNaFziLNx9AEOD[79],W7UNaFziLNx9AEOD[79],PZmJb2jOe.LogoPath)NtE1VN:GlueTop(EljyyLgk2f7X,vjUhhaKyS,W7UNaFziLNx9AEOD[26],W7UNaFziLNx9AEOD[26],W7UNaFziLNx9AEOD[80])NtE1VN:GlueBottom(vjUhhaKyS,EQkUAp9SDnxEA946FtSwl,-W7UNaFziLNx9AEOD[67],W7UNaFziLNx9AEOD[67],W7UNaFziLNx9AEOD[81])EQkUAp9SDnxEA946FtSwl.resultsLabel=NtE1VN:Label(EQkUAp9SDnxEA946FtSwl,W7UNaFziLNx9AEOD[31],W7UNaFziLNx9AEOD[82])NtE1VN:GlueBottom(EQkUAp9SDnxEA946FtSwl.resultsLabel,EQkUAp9SDnxEA946FtSwl,W7UNaFziLNx9AEOD[67],W7UNaFziLNx9AEOD[83],W7UNaFziLNx9AEOD[84])local UAJNMvFycTQ1T=NtE1VN:Button(EQkUAp9SDnxEA946FtSwl,W7UNaFziLNx9AEOD[85],W7UNaFziLNx9AEOD[82],W7UNaFziLNx9AEOD[86])NtE1VN:GlueBottom(UAJNMvFycTQ1T,EQkUAp9SDnxEA946FtSwl,W7UNaFziLNx9AEOD[26],W7UNaFziLNx9AEOD[67],W7UNaFziLNx9AEOD[87])UAJNMvFycTQ1T:SetScript(W7UNaFziLNx9AEOD[88],function()nJEPCUmS:DrawClearWarningWindow()end)self.tradelogWindow=EQkUAp9SDnxEA946FtSwl end;function nJEPCUmS:DrawClearWarningWindow()local bT60Vbbf3={character={text=W7UNaFziLNx9AEOD[89],onClick=function(_aF7QGKsCsZXevscEy)nJEPCUmS:ClearMailForCharacter()_aF7QGKsCsZXevscEy.window:Hide()end},all={text=W7UNaFziLNx9AEOD[90],onClick=function(CfEZFPL)nJEPCUmS:ClearAllMail()CfEZFPL.window:Hide()end}}NtE1VN:Confirm(W7UNaFziLNx9AEOD[91],W7UNaFziLNx9AEOD[92],bT60Vbbf3,W7UNaFziLNx9AEOD[25])end;function nJEPCUmS:ClearMailForCharacter()local ijXmIUDHN7wgYa1Oi0slE,b=UnitFullName(W7UNaFziLNx9AEOD[93])local zqGJYZrX1XHAo9sImGoD9=ijXmIUDHN7wgYa1Oi0slE..W7UNaFziLNx9AEOD[94]..b;for K,NwE7yC3c in pairs(PZmJb2jOe.db.global.tradelog)do if NwE7yC3c.source==zqGJYZrX1XHAo9sImGoD9 or NwE7yC3c.destination==zqGJYZrX1XHAo9sImGoD9 then PZmJb2jOe.db.global.tradelog[K]=W7UNaFziLNx9AEOD[31]end end;if(self.tradelogWindow)then nJEPCUmS:SearchTrades(self.tradelogWindow.searchBox:GetText())end end;function nJEPCUmS:ClearAllMail()for mylUN,daNVBA3Erh6zmRN9r in pairs(PZmJb2jOe.db.global.tradelog)do PZmJb2jOe.db.global.tradelog[mylUN]=W7UNaFziLNx9AEOD[31]end;if(self.tradelogWindow)then nJEPCUmS:SearchTrades(self.tradelogWindow.searchBox:GetText())end end;function nJEPCUmS:DrawSearchPane()local wMX1M_Rd9IdGvN=self.tradelogWindow;local nO2Ers5pK8BtitO74q=NtE1VN:Autocomplete(wMX1M_Rd9IdGvN,W7UNaFziLNx9AEOD[95],W7UNaFziLNx9AEOD[96],W7UNaFziLNx9AEOD[8],W7UNaFziLNx9AEOD[31],W7UNaFziLNx9AEOD[31],W7UNaFziLNx9AEOD[31])NtE1VN:ApplyPlaceholder(nO2Ers5pK8BtitO74q,W7UNaFziLNx9AEOD[97],W7UNaFziLNx9AEOD[98])nO2Ers5pK8BtitO74q:SetFontSize(W7UNaFziLNx9AEOD[82])local iLawVpdg=NtE1VN:Button(wMX1M_Rd9IdGvN,W7UNaFziLNx9AEOD[99],W7UNaFziLNx9AEOD[96],W7UNaFziLNx9AEOD[100])NtE1VN:GlueTop(nO2Ers5pK8BtitO74q,wMX1M_Rd9IdGvN,W7UNaFziLNx9AEOD[67],-W7UNaFziLNx9AEOD[101],W7UNaFziLNx9AEOD[102])NtE1VN:GlueTop(iLawVpdg,wMX1M_Rd9IdGvN,W7UNaFziLNx9AEOD[103],-W7UNaFziLNx9AEOD[101],W7UNaFziLNx9AEOD[104])nO2Ers5pK8BtitO74q:SetScript(W7UNaFziLNx9AEOD[105],function()nJEPCUmS:SearchTrades(nO2Ers5pK8BtitO74q:GetText())end)iLawVpdg:SetScript(W7UNaFziLNx9AEOD[106],function()nJEPCUmS:SearchTrades(nO2Ers5pK8BtitO74q:GetText())end)local OHUuknK4wdcXFDSNAlcV=NtE1VN:Checkbox(wMX1M_Rd9IdGvN,W7UNaFziLNx9AEOD[107])NtE1VN:GlueRight(OHUuknK4wdcXFDSNAlcV,iLawVpdg,W7UNaFziLNx9AEOD[67],W7UNaFziLNx9AEOD[26])OHUuknK4wdcXFDSNAlcV.OnValueChanged=function(p15EBzsZhqtFQQ,G2QDrXo3MAbzZzynXIZbw)nJEPCUmS:SearchTrades(nO2Ers5pK8BtitO74q:GetText())end;local H17kGQ6IT5=NtE1VN:FrameTooltip(OHUuknK4wdcXFDSNAlcV,W7UNaFziLNx9AEOD[108],W7UNaFziLNx9AEOD[109],W7UNaFziLNx9AEOD[110],W7UNaFziLNx9AEOD[47])local hQkcXp=NtE1VN:Checkbox(wMX1M_Rd9IdGvN,W7UNaFziLNx9AEOD[111])NtE1VN:GlueRight(hQkcXp,OHUuknK4wdcXFDSNAlcV,W7UNaFziLNx9AEOD[67],W7UNaFziLNx9AEOD[26])hQkcXp.OnValueChanged=function(RKqzXuOoH,Bv7F)nJEPCUmS:SearchTrades(nO2Ers5pK8BtitO74q:GetText())end;local ZkuvC8NO_GI51hNuWRX=NtE1VN:FrameTooltip(hQkcXp,W7UNaFziLNx9AEOD[112],W7UNaFziLNx9AEOD[113],W7UNaFziLNx9AEOD[114],W7UNaFziLNx9AEOD[47])wMX1M_Rd9IdGvN.allCharactersToggle=OHUuknK4wdcXFDSNAlcV;wMX1M_Rd9IdGvN.todayToggle=hQkcXp;wMX1M_Rd9IdGvN.searchBox=nO2Ers5pK8BtitO74q;wMX1M_Rd9IdGvN.searchButton=iLawVpdg end;function nJEPCUmS:DrawSearchResultsTable()local grY1bz2FNJ=self.tradelogWindow;local function aoRGcE8D9Ztib2(pstKaZBCEtHEuh_jsTOx4,x_at1q_r4wXudxDZoj,T_r)if x_at1q_r4wXudxDZoj and T_r~=W7UNaFziLNx9AEOD[31]then GameTooltip:SetOwner(pstKaZBCEtHEuh_jsTOx4)GameTooltip:SetText(T_r)else GameTooltip:Hide()end end;local B5hC3nT2VjvMPywHRRma={{name=W7UNaFziLNx9AEOD[115],width=W7UNaFziLNx9AEOD[77],align=W7UNaFziLNx9AEOD[116],index=W7UNaFziLNx9AEOD[117],format=function(OTdmlFghuTEdXE)return OTdmlFghuTEdXE and(OTdmlFghuTEdXE..W7UNaFziLNx9AEOD[118])or W7UNaFziLNx9AEOD[8]end,defaultSort=W7UNaFziLNx9AEOD[119]},{name=W7UNaFziLNx9AEOD[120],width=W7UNaFziLNx9AEOD[121],align=W7UNaFziLNx9AEOD[122],index=W7UNaFziLNx9AEOD[123],format=W7UNaFziLNx9AEOD[124]},{name=W7UNaFziLNx9AEOD[125],width=W7UNaFziLNx9AEOD[121],align=W7UNaFziLNx9AEOD[126],index=W7UNaFziLNx9AEOD[127],format=W7UNaFziLNx9AEOD[128]},{name=W7UNaFziLNx9AEOD[129],width=W7UNaFziLNx9AEOD[121],align=W7UNaFziLNx9AEOD[130],index=W7UNaFziLNx9AEOD[131],format=W7UNaFziLNx9AEOD[132],events={OnEnter=function(ZsLbCDzGbii7qp5XaGcK1,z5izAnt1JaLXj,zkVbl26_v3xP3uluxZ,FOJDYpApdB5pa_a32,qCdSST_OVLMsuc9aeXv,re2pl5LbgEZ)local Aqn7mGczHd1FFOeV=FOJDYpApdB5pa_a32[qCdSST_OVLMsuc9aeXv.index]if FOJDYpApdB5pa_a32.playerItems then aoRGcE8D9Ztib2(z5izAnt1JaLXj,W7UNaFziLNx9AEOD[47],FOJDYpApdB5pa_a32.playerItems)end;return W7UNaFziLNx9AEOD[47]end,OnLeave=function(ZkwGQVQArtKcFMA,HwfGEjaXodIK9x4duH)aoRGcE8D9Ztib2(HwfGEjaXodIK9x4duH,W7UNaFziLNx9AEOD[133])return W7UNaFziLNx9AEOD[47]end}},{name=W7UNaFziLNx9AEOD[134],width=W7UNaFziLNx9AEOD[51],align=W7UNaFziLNx9AEOD[135],index=W7UNaFziLNx9AEOD[136],format=W7UNaFziLNx9AEOD[137]},{name=W7UNaFziLNx9AEOD[138],width=W7UNaFziLNx9AEOD[51],align=W7UNaFziLNx9AEOD[139],index=W7UNaFziLNx9AEOD[140],format=W7UNaFziLNx9AEOD[141]},{name=W7UNaFziLNx9AEOD[142],width=W7UNaFziLNx9AEOD[121],align=W7UNaFziLNx9AEOD[143],index=W7UNaFziLNx9AEOD[144],format=W7UNaFziLNx9AEOD[145],events={OnEnter=function(C1pgIRTKtGbgULsFT3p2,Cjeces0aQLQKUCAj,w9wtofZolcUgAn6,Ip1SlR,MFEAw7TNc,_q5AQxCYzKvB5WhHU4V)local TgQqok=Ip1SlR[MFEAw7TNc.index]if Ip1SlR.targetItems then aoRGcE8D9Ztib2(Cjeces0aQLQKUCAj,W7UNaFziLNx9AEOD[47],Ip1SlR.targetItems)end;return W7UNaFziLNx9AEOD[47]end,OnLeave=function(W,udMzC9oL3uQmsFoVeP50)aoRGcE8D9Ztib2(udMzC9oL3uQmsFoVeP50,W7UNaFziLNx9AEOD[133])return W7UNaFziLNx9AEOD[47]end}}}grY1bz2FNJ.searchResults=NtE1VN:ScrollTable(grY1bz2FNJ,B5hC3nT2VjvMPywHRRma,W7UNaFziLNx9AEOD[146],W7UNaFziLNx9AEOD[147])grY1bz2FNJ.searchResults:EnableSelection(W7UNaFziLNx9AEOD[47])grY1bz2FNJ.searchResults:SetScript(W7UNaFziLNx9AEOD[148],function(CXgyOD6xhd2ZHBj)local J7233IRkrrRfsd=CXgyOD6xhd2ZHBj:GetWidth()local Xy=CXgyOD6xhd2ZHBj:GetHeight()local gQOcn6rCgLqS_oqY4iZY=W7UNaFziLNx9AEOD[26]for k=W7UNaFziLNx9AEOD[25],#CXgyOD6xhd2ZHBj.columns do gQOcn6rCgLqS_oqY4iZY=gQOcn6rCgLqS_oqY4iZY+CXgyOD6xhd2ZHBj.columns[k].width end;for k=W7UNaFziLNx9AEOD[25],#CXgyOD6xhd2ZHBj.columns do CXgyOD6xhd2ZHBj.columns[k]:SetWidth(CXgyOD6xhd2ZHBj.columns[k].width/gQOcn6rCgLqS_oqY4iZY* (J7233IRkrrRfsd-W7UNaFziLNx9AEOD[96]))end;CXgyOD6xhd2ZHBj:SetDisplayRows(math.floor(Xy/CXgyOD6xhd2ZHBj.rowHeight),CXgyOD6xhd2ZHBj.rowHeight)end)NtE1VN:GlueAcross(grY1bz2FNJ.searchResults,grY1bz2FNJ,W7UNaFziLNx9AEOD[67],-W7UNaFziLNx9AEOD[149],-W7UNaFziLNx9AEOD[67],W7UNaFziLNx9AEOD[150])grY1bz2FNJ.stateLabel=NtE1VN:Label(grY1bz2FNJ.searchResults,W7UNaFziLNx9AEOD[151])NtE1VN:GlueTop(grY1bz2FNJ.stateLabel,grY1bz2FNJ.searchResults,W7UNaFziLNx9AEOD[26],-W7UNaFziLNx9AEOD[101],W7UNaFziLNx9AEOD[152])end;function nJEPCUmS:ApplyDefaultSort(joLczFvbd)if(self.tradelogWindow.searchResults.head.columns)then local Mg_NDYf=W7UNaFziLNx9AEOD[133]for XpLGEErBTXJdwBgEj6Bv,ZG0ZIFZi0pgdQNxTIhYq_ in pairs(self.tradelogWindow.searchResults.head.columns)do if(ZG0ZIFZi0pgdQNxTIhYq_.arrow:IsVisible())then Mg_NDYf=W7UNaFziLNx9AEOD[47]end end;if(not Mg_NDYf)then return table.sort(joLczFvbd,function(Ad_Y0q3QMi622qtYCa0w,IAK9LHx)return Ad_Y0q3QMi622qtYCa0w[W7UNaFziLNx9AEOD[153]]>IAK9LHx[W7UNaFziLNx9AEOD[154]]end)end end;return joLczFvbd end;function nJEPCUmS:UpdateStateText()if(#self.currentView>W7UNaFziLNx9AEOD[26])then self.tradelogWindow.stateLabel:Hide()else self.tradelogWindow.stateLabel:SetText(W7UNaFziLNx9AEOD[155])end end;function nJEPCUmS:UpdateResultsText()if(#self.currentView>W7UNaFziLNx9AEOD[26])then self.tradelogWindow.resultsLabel:SetText(W7UNaFziLNx9AEOD[156]..tostring(#self.currentView))self.tradelogWindow.resultsLabel:Show()else self.tradelogWindow.resultsLabel:Hide()end end;function nJEPCUmS:EnsureFullName(o)if not o:find(W7UNaFziLNx9AEOD[157])then o=o..W7UNaFziLNx9AEOD[158]..select(W7UNaFziLNx9AEOD[159],UnitFullName(W7UNaFziLNx9AEOD[160]))end;return o end;function nJEPCUmS:Finish()self.pendingTradeContents={}self.targetName=W7UNaFziLNx9AEOD[8]self.targetRealm=W7UNaFziLNx9AEOD[8]self.targetNameRealm=W7UNaFziLNx9AEOD[8]end;function nJEPCUmS:CleanUp()local nEA=PZmJb2jOe.db.global.tradelog;local FRUdsFHQ1tnjT=W7UNaFziLNx9AEOD[26]local b2HH7QVYg2f=PZmJb2jOe.db.global.logCleanupDays;for j6q8SE,OtAOCBmf in pairs(nEA)do local hPMhzfU2EGdS8cwtn1Sx5=PZmJb2jOe.helperFunctions:IsOlderThanDays(OtAOCBmf.date,b2HH7QVYg2f)if hPMhzfU2EGdS8cwtn1Sx5 ==W7UNaFziLNx9AEOD[47]then FRUdsFHQ1tnjT=FRUdsFHQ1tnjT+W7UNaFziLNx9AEOD[25]nEA[j6q8SE]=W7UNaFziLNx9AEOD[31]end end;if FRUdsFHQ1tnjT>W7UNaFziLNx9AEOD[26]then PZmJb2jOe:Printf(W7UNaFziLNx9AEOD[161],FRUdsFHQ1tnjT,b2HH7QVYg2f)end end